<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>写点东西试试</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="多学多想多试">
<meta property="og:type" content="website">
<meta property="og:title" content="写点东西试试">
<meta property="og:url" content="http://hongdaorongthink.github.io/index.html">
<meta property="og:site_name" content="写点东西试试">
<meta property="og:description" content="多学多想多试">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="写点东西试试">
<meta name="twitter:description" content="多学多想多试">
  
    <link rel="alternate" href="/atom.xml" title="写点东西试试" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  

</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">写点东西试试</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">胆大点、心细点</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://hongdaorongthink.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-收藏夹" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/10/收藏夹/" class="article-date">
  <time datetime="2016-08-10T09:15:13.000Z" itemprop="datePublished">2016-08-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/10/收藏夹/">收藏夹</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="公司内网"><a href="#公司内网" class="headerlink" title="公司内网"></a>公司内网</h1><ul>
<li><a href="192.168.14.12:9000/WebBase" target="_blank" rel="external">loft网站</a></li>
<li><a href="192.168.15.44:8080/WebBase" target="_blank" rel="external">loft 网站测试</a></li>
<li><a href="192.168.14.12">财富网站</a></li>
<li><a href="192.168.15.44">财富网站测试</a></li>
</ul>
<h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><ul>
<li>[lycf/lycf@192.168.14.12/lytzats]</li>
<li>[ats/ats@192.168.14.12/lytzats]</li>
<li>[ats_pm/ats_pm@192.168.14.12/lytzats]</li>
<li>[optdb/optdb@115.28.144.36/eas]</li>
</ul>
<h1 id="git-仓库"><a href="#git-仓库" class="headerlink" title="git 仓库"></a>git 仓库</h1><ul>
<li><a href="http://139.129.96.220:3000" target="_blank" rel="external">220 gogs git</a></li>
<li><a href="192.168.15.44:3000" target="_blank" rel="external">44 gogs git</a></li>
</ul>
<h1 id="书签"><a href="#书签" class="headerlink" title="书签"></a>书签</h1><ul>
<li><a href="http://www.baidu.com" target="_blank" rel="external">百度</a></li>
<li><a href="https://worktile.com" target="_blank" rel="external">worktile</a></li>
<li><a href="http://www.360doc.com/content/13/0117/11/2886802_260681908.shtml" target="_blank" rel="external">LaTeX 教程</a></li>
<li><a href="http://www.runoob.com/" target="_blank" rel="external">菜鸟教程</a></li>
<li><a href="http://www.scipy.org/" target="_blank" rel="external">scipy</a></li>
<li><a href="https://hexo.io/" target="_blank" rel="external">hexo.io</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/08/10/收藏夹/" data-id="cirou3vu6000ta8m3q5xo5ug3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/书签/">书签</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-antlr4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/08/antlr4/" class="article-date">
  <time datetime="2016-08-08T09:20:35.000Z" itemprop="datePublished">2016-08-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/08/antlr4/">antlr4</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="How-to-create-a-Python-lexer-or-parser"><a href="#How-to-create-a-Python-lexer-or-parser" class="headerlink" title="How to create a Python lexer or parser"></a>How to create a Python lexer or parser</h1><pre><code>antlr4 -Dlanguage=Python2 MyGrammar.g4
or
antlr4 -Dlanguage=Python3 MyGrammar.g4
</code></pre><h1 id="Р§зг"><a href="#Р§зг" class="headerlink" title="Р§зг"></a>Р§зг</h1><p>[<a href="https://github.com/jszheng/py3antlr4book.git" target="_blank" rel="external">https://github.com/jszheng/py3antlr4book.git</a> ]</p>
<h1 id="mytst-py"><a href="#mytst-py" class="headerlink" title="mytst.py"></a>mytst.py</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mytest.py</span></div><div class="line"><span class="keyword">from</span> antlr4 <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> MyGrammarLexer <span class="keyword">import</span> MyGrammarLexer</div><div class="line"><span class="keyword">from</span> MyGrammarParser <span class="keyword">import</span> MyGrammarParser</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(argv)</span>:</span></div><div class="line">    input = FileStream(argv[<span class="number">1</span>])</div><div class="line">    lexer = MyGrammarLexer(input)</div><div class="line">    stream = CommonTokenStream(lexer)</div><div class="line">    parser = MyGrammarParser(stream)</div><div class="line">    tree = parser.StartRule()</div><div class="line"> </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main(sys.argv)</div></pre></td></tr></table></figure>
<p>This program will work. But it won’t be useful unless you do one of the following:</p>
<ul>
<li>you visit the parse tree using a custom listener</li>
<li>you visit the parse tree using a custom visitor</li>
<li>your grammar comprises production code (like AntLR3)<br>(please note that production code is target specific, so you can’t have multi target grammars that include production code, except for very limited use cases, see below)</li>
</ul>
<h1 id="How-do-I-create-and-run-a-custom-listener"><a href="#How-do-I-create-and-run-a-custom-listener" class="headerlink" title="How do I create and run a custom listener?"></a>How do I create and run a custom listener?</h1><p>Let’s suppose your MyGrammar grammar comprises 2 rules: “key” and “value”.<br>The antlr4 tool will have generated the following listener: </p>
<p>class MyGrammarListener(ParseTreeListener):<br>    def enterKey(self, ctx):<br>        pass<br>    def exitKey(self, ctx):<br>        pass<br>    def enterValue(self, ctx):<br>        pass<br>    def exitValue(self, ctx):<br>        pass</p>
<p> In order to provide custom behavior, you might want to create the following class:</p>
<p>class KeyPrinter(MyGrammarListener):<br>    def exitKey(self, ctx):<br>        print(“Oh, a key!”) </p>
<p>In order to execute this listener, you would simply add the following lines to the above code:</p>
<pre><code>...
tree = parser.StartRule() - only repeated here for reference
</code></pre><p>   printer = KeyPrinter()<br>   walker = ParseTreeWalker()<br>   walker.walk(printer, tree)</p>
<p>Further information can be found from the AntLR4 definitive guide.</p>
<p>============================================================================================================================</p>
<h2 id="Getting-Started-with-ANTLR-v4"><a href="#Getting-Started-with-ANTLR-v4" class="headerlink" title="Getting Started with ANTLR v4"></a>Getting Started with ANTLR v4</h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>Hi and welcome to the version 4 release of ANTLR! It’s named after the fearless hero of the Crazy Nasty-Ass Honey Badger since ANTLR v4 takes whatever you give it–it just doesn’t give a crap! See Why do we need ANTLR v4? and the preface of the ANTLR v4 book.</p>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><p>antlr 包含两个东西 : 生成 parser/lexer 的 java 类(或者其他目标语言) 的工具 和 parser/lexer 运行的环境。即使使用 antlr intellij 插件 或者 antlrworkds 运行antlr工具 生成的代码仍然需要运行库.<br>首先 你要下载 安装 开发工具插件。即使你只需要编辑语法文件，使用工具效果很好.<br>然后按照以下教程暗转环境运行 parser/lexer.<br>使用 antlr-4.5-complete.jar 作为例子，包含了生成工具和运行库以及其他库<br>附:antlr v4 使用 v3写的</p>
<p>如果你要教程 antlr 到你的项目中, 使用 mvn, ant, 或者你要集成 antlr 到开发工具中 比如 eclipse 或 intellij 请看 [<a href="https://theantlrguy.atlassian.net/wiki/display/ANTLR4/Integrating+ANTLR+into+Development+Systems" target="_blank" rel="external">https://theantlrguy.atlassian.net/wiki/display/ANTLR4/Integrating+ANTLR+into+Development+Systems</a> Integrating ANTLR into Development Systems]</p>
<h4 id="unix"><a href="#unix" class="headerlink" title="unix"></a>unix</h4><ol>
<li>安装 java (1.6 ??)</li>
<li>下载<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd /usr/local/<span class="class"><span class="keyword">lib</span></span></div><div class="line">$ curl -O <span class="symbol">http:</span>/<span class="regexp">/www.antlr.org/download</span><span class="regexp">/antlr-4.5-complete.jar</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>或者直接在浏览器中下载<br>[<a href="http://www.antlr.org/download.html" target="_blank" rel="external">http://www.antlr.org/download.html</a> ]<br>下载后放到有效目录 比如 /usr/local/lib.</p>
<ol>
<li>将 antlr-4.5-complete.jar 添加到 CLASSPATH:<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">export</span> CLASSPATH=<span class="string">".:/usr/local/lib/antlr-4.5-complete.jar:<span class="variable">$CLASSPATH</span>"</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>将这条命令放到放到你的 .bash_profile 或者其他任何启动脚本也是很好的主意</p>
<ol>
<li>给 生成命令和测试命令起别名 antlr 和 testrig<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span><span class="keyword">alias</span> antlr4=<span class="string">'java -Xmx500M -cp "/usr/local/lib/antlr-4.5-complete.jar:$CLASSPATH" org.antlr.v4.Tool'</span></div><div class="line"><span class="variable">$ </span><span class="keyword">alias</span> grun=<span class="string">'java org.antlr.v4.runtime.misc.TestRig'</span></div></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><ol>
<li>安装 java (1.6 ??)</li>
<li><p>下载<br><a href="http://www.antlr.org/download/antlr-4.5-complete.jar" target="_blank" rel="external">http://www.antlr.org/download/antlr-4.5-complete.jar</a><br>下载后放到自己的java库目录 比如 d:\javalib.</p>
</li>
<li><p>将 antlr-4.5-complete.jar 添加到 CLASSPATH:</p>
</li>
</ol>
<ul>
<li>永久的 : 环境变量<h1 id="临时的"><a href="#临时的" class="headerlink" title="临时的"></a>临时的</h1><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SET CLASSPATH=.;C:<span class="symbol">\J</span>avalib<span class="symbol">\a</span>ntlr-4.5-complete.jar;<span class="variable">%CLASSPATH%</span></div></pre></td></tr></table></figure>
</li>
</ul>
<ol>
<li>使用批处理或者doskey来创建快捷命令</li>
</ol>
<ul>
<li><p>批处理文件  antlr4.bat</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SET CLASSPATH=.<span class="comment">;C:\Javalib\antlr-4.5-complete.jar;%CLASSPATH%</span></div><div class="line"><span class="keyword">java </span><span class="keyword">org.antlr.v4.Tool </span>%*</div></pre></td></tr></table></figure>
</li>
<li><p>批处理文件  grun.bat</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SET <span class="keyword">CLASSPATH</span>=.;C:\Javalib\antlr-<span class="number">4.5</span>-complete.jar;%<span class="keyword">CLASSPATH</span>%</div><div class="line">java org.antlr.v4.<span class="keyword">runtime</span>.misc.TestRig %*</div></pre></td></tr></table></figure>
</li>
<li><p>使用 doskey </p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">doskey antlr4=<span class="keyword">java </span><span class="keyword">org.antlr.v4.Tool </span>$*</div><div class="line">doskey grun =<span class="keyword">java </span><span class="keyword">org.antlr.v4.runtime.misc.TestRig </span>$*</div></pre></td></tr></table></figure>
</li>
</ul>
<p>grun 选项<br>r -tokens   打印每个tokens<br>r -tree    LISP格式打印<br>r -gui      图形化打印</p>
<h4 id="测试安装是否成功"><a href="#测试安装是否成功" class="headerlink" title="测试安装是否成功"></a>测试安装是否成功</h4><ul>
<li><p>运行 org.antlr.v4.Tool</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ java -jar /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">antlr</span>-4.5-<span class="title">complete</span>.<span class="title">jar</span></span></div><div class="line">ANTLR Parser Generator Version <span class="number">4.5</span></div><div class="line">-o ___ specify output directory where all output is generated</div><div class="line">-<span class="class"><span class="keyword">lib</span> <span class="title">___</span> <span class="title">specify</span> <span class="title">location</span> <span class="title">of</span> .<span class="title">tokens</span> <span class="title">files</span></span></div><div class="line">...</div></pre></td></tr></table></figure>
</li>
<li><p>使用 jar 选项</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ java -jar /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">antlr</span>-4.5-<span class="title">complete</span>.<span class="title">jar</span></span></div><div class="line">ANTLR Parser Generator Version <span class="number">4.5</span></div><div class="line">-o ___ specify output directory where all output is generated</div><div class="line">-<span class="class"><span class="keyword">lib</span> <span class="title">___</span> <span class="title">specify</span> <span class="title">location</span> <span class="title">of</span> .<span class="title">tokens</span> <span class="title">files</span></span></div><div class="line">...</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="第一个例子"><a href="#第一个例子" class="headerlink" title="第一个例子"></a>第一个例子</h3><p>创建文件  Hello.g4<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Define a grammar called Hello</span></div><div class="line">grammar Hello;</div><div class="line"><span class="string">r  :</span> <span class="string">'hello'</span> ID ;         <span class="comment">// match keyword hello followed by an identifier</span></div><div class="line"><span class="string">ID :</span> [a-z]+ ;             <span class="comment">// match lower-case identifiers</span></div><div class="line"><span class="string">WS :</span> [ \t\r\n]+ -&gt; skip ; <span class="comment">// skip spaces, tabs, newlines</span></div></pre></td></tr></table></figure></p>
<p>任何一个匹配就是一个token<br>token 提供了匹配位置在第几行，从那个位置开始到那个位置等信息</p>
<p>运行生成工具<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>cd /tmp</div><div class="line"><span class="variable">$ </span>antlr4 Hello.g4</div><div class="line"><span class="variable">$ </span>javac Hello*.java</div></pre></td></tr></table></figure></p>
<p>测试生成的代码<br><figure class="highlight cos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ grun Hello <span class="keyword">r</span> -tree</div><div class="line">hello parrt</div><div class="line"><span class="symbol">^D</span></div><div class="line">(<span class="keyword">r</span> hello parrt)</div></pre></td></tr></table></figure></p>
<pre><code>^D 是输入结束, windows 下是 ^Z
-tree 选项 让输出为 LISP 语法
</code></pre><p>图形化显示解析结果<br><figure class="highlight cos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ grun Hello <span class="keyword">r</span> -gui</div><div class="line">hello parrt</div><div class="line"><span class="symbol">^D</span></div></pre></td></tr></table></figure></p>
<p>=================================================================================================================================================================</p>
<h2 id="使用antlr4ide"><a href="#使用antlr4ide" class="headerlink" title="使用antlr4ide"></a>使用antlr4ide</h2><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ul>
<li>antlr 4</li>
<li>语法高亮</li>
<li>自动代码生成(保存文件时)</li>
<li>手动代码生成</li>
<li>代码格式化 (ctrl+shift+F)</li>
<li>html显示语法图表</li>
<li>Live Parse Tree evaluation 动态解析 Parse Tree 计算</li>
<li>文件间高级规则导航 (F3 或者 ctrl+左键点击一个规则)</li>
<li>快速修复</li>
</ul>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>eclipse 4.4 luna<br>XText 2.7.3</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>关联了*.g4 文件</p>
<h3 id="生成代码"><a href="#生成代码" class="headerlink" title="生成代码"></a>生成代码</h3><p>如果语法正确, 每次保存都会自动生成代码.要关闭自动生成 window &gt; preferences &gt; antlr 4 &gt; tool : [ ] tool is activated </p>
<h3 id="手动生成代码"><a href="#手动生成代码" class="headerlink" title="手动生成代码"></a>手动生成代码</h3><p>run &gt; as antlr 4<br>修改配置 Run &gt; External Tools &gt; External Tools Configurations…<br> 生成python代码选项 -Dlanguage=Python2</p>
<h3 id="语法图表"><a href="#语法图表" class="headerlink" title="语法图表"></a>语法图表</h3><p>window &gt; show view &gt; other &gt; syntax diagram</p>
<h3 id="使用-maven-3-编译"><a href="#使用-maven-3-编译" class="headerlink" title="使用 maven 3 编译"></a>使用 maven 3 编译</h3><p><em>. Fork and clone the repository from github
</em>. Download and install Maven 3.x<br><em>. Open a shell console and type: cd antlr4ide
</em>. Build the project with: mvn clean package<br><em>. It takes a while to download and configure Eclipse dependencies, so be patient
</em>. Wait for a: BUILD SUCCESS message</p>
<p>===============================================================</p>
<blockquote>
<p>antlr4py2 Hello.g4</p>
</blockquote>
<p>由g4 文件得到 对应的 Lexer , Listener, Parser, 和 token文件</p>
<p>ANTLR在运行时库里提供灵活的测试工具称为TestRig</p>
<p>grun Hello r -tokens    # start the TestRig on grammar Hello at rule r</p>
<p>语法   规则   分词器</p>
<p>[“1,6:10 = ‘parrt’,＜2＞,1:6]<br>表明第二个token（索引从0开始），<br>从字符位置6到10（从0开始），<br>有文本parrt，<br>是第二个标记（ID），<br>位置是在第一行（行数从1开始），在第6个字符处（位置是从零开始计算，tabs也算作一个独立的字符）。</p>
<p>小写表示定义语法</p>
<p>大写表示定义词法 </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/08/08/antlr4/" data-id="cirou3vtk000ca8m3kjttec1r" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/antlr/">antlr</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/语法解析/">语法解析</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-学习框架" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/08/学习框架/" class="article-date">
  <time datetime="2016-08-08T00:46:54.000Z" itemprop="datePublished">2016-08-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/08/学习框架/">学习框架</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="hexo"><a href="#hexo" class="headerlink" title="hexo "></a>hexo </h1><p>hexo init 创建用户项目 hexo-size</p>
<h2 id="lib"><a href="#lib" class="headerlink" title="lib:"></a>lib:</h2><ul>
<li>box</li>
<li>extend</li>
<li>hexo</li>
<li>models</li>
<li>plugins</li>
<li>theme</li>
</ul>
<h2 id="hexo-1"><a href="#hexo-1" class="headerlink" title="hexo "></a>hexo </h2><ul>
<li><p>index.js<br>定义了 Hexo 类, 作为 EventEmitter 的派生类</p>
<blockquote>
<p>function Hexo(){<br>  EventEmitter.call(this);    // domain 对 EventEmitter 构造函数有影响, 调用这个 call 抵消影响<br>}<br>require(‘util’).inherits(Hexo, EventEmitter);</p>
<ul>
<li>Hexo.prototype._bindLocals    // posts,pages categories, tags, data 等配置的 和 db.json  关联</li>
<li>Hexo.prototype.init   // Bluebird-NodeJs的Promise提供了一个更加清晰和健壮的方式编写异步代码, 简洁的方式写回调函数</li>
<li>Hexo.prototype.call   // 对控制台输入做相应的调用</li>
<li>Hexo.prototype.loadPlugin // 执行指定的nodejs脚本</li>
<li>Hexo.prototype.load   // 调用 loadDatabase, source.process, theme.process </li>
<li>Hexo.prototype.watch  // 调用 source.watch, theme.watch </li>
<li>Hexo.prototype._generate  // toObject, view.render, save</li>
<li>Hexo.prototype.exit   // </li>
<li>Hexo.prototype.execFilter //<br>module.exports = Hexo;</li>
</ul>
</blockquote>
</li>
<li><p>post.js<br>Post 类, 使用Hexo对象作为构造参数, </p>
<blockquote>
<p>function Post(context)</p>
</blockquote>
</li>
</ul>
<h1 id="django"><a href="#django" class="headerlink" title="django"></a>django</h1><h1 id="flask"><a href="#flask" class="headerlink" title="flask"></a>flask</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/08/08/学习框架/" data-id="cirou3vu4000ra8m3r17220bq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-科学计算" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/03/科学计算/" class="article-date">
  <time datetime="2016-08-03T14:12:36.000Z" itemprop="datePublished">2016-08-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/03/科学计算/">科学计算</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="利用-python-进行数据-分析"><a href="#利用-python-进行数据-分析" class="headerlink" title="利用 python 进行数据 分析"></a>利用 python 进行数据 分析</h1><h1 id="python-for-data-analysis"><a href="#python-for-data-analysis" class="headerlink" title="python for data analysis"></a>python for data analysis</h1><h1 id="wes-mckinney"><a href="#wes-mckinney" class="headerlink" title="wes mckinney"></a>wes mckinney</h1><h1 id="numpy-numerical-python"><a href="#numpy-numerical-python" class="headerlink" title="numpy - numerical python"></a>numpy - numerical python</h1><p>python 科学计算的基础包</p>
<blockquote>
<p>多位数组对象 ndarray<br>对数组执行运算<br>读写基于数据的磁盘数据<br>线性代数运算，傅里叶变换，随机数生成<br>c, c++, fortran 集成到 python 的工具</p>
</blockquote>
<h1 id="pandas-panel-data-python-data-analysis"><a href="#pandas-panel-data-python-data-analysis" class="headerlink" title="pandas - panel data - python data analysis"></a>pandas - panel data - python data analysis</h1><blockquote>
<p>数据处理的大量数据结构和函数<br>就像集成了 excel<br>用于金融数据的工具</p>
</blockquote>
<h1 id="matplotlib"><a href="#matplotlib" class="headerlink" title="matplotlib"></a>matplotlib</h1><blockquote>
<p>用户绘制图表</p>
</blockquote>
<h1 id="ipython"><a href="#ipython" class="headerlink" title="ipython"></a>ipython</h1><blockquote>
<p>增强的 python shell</p>
</blockquote>
<h1 id="scipy"><a href="#scipy" class="headerlink" title="scipy"></a>scipy</h1><blockquote>
<p>解决科学计算的标准问题<br>scipy.integrate - 数值积分例程和微分方程求解器<br>scipy.linalg - 扩展 numpy.linalg 的线性代数例程和矩阵分解<br>scipy.optmize - 函数优化器(最小化器)以及根查找算法<br>scipy.signal - 信号处理工具<br>scipy.sparse - 稀疏矩阵和稀疏线性系统求解器<br>scipy.special - 实现许多常用数学函数<br>scipy.stats - 标准连续和离散概率分布<br>scipy.weave - 加速的数组计算</p>
</blockquote>
<pre><code>* 在学校的时候下载安装过 python(x, y)，进展到打开界面就不知道了 
</code></pre><h1 id="命名惯例"><a href="#命名惯例" class="headerlink" title="命名惯例"></a>命名惯例</h1><blockquote>
<p>import numpy as np<br>import pandas as pd<br>import matplotlib.pyllot as plt</p>
</blockquote>
<h1 id="术语"><a href="#术语" class="headerlink" title="术语"></a>术语</h1><p>Munge/munging/wrangling - 散列数据规整为结构数据 </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/08/03/科学计算/" data-id="cirou3vud0012a8m3sf7bsyyx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据分析/">数据分析</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-写一个简单服务框架" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/01/写一个简单服务框架/" class="article-date">
  <time datetime="2016-08-01T00:58:32.000Z" itemprop="datePublished">2016-08-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/01/写一个简单服务框架/">写一个简单服务框架</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="redis-高级"><a href="#redis-高级" class="headerlink" title="redis 高级"></a>redis 高级</h1><ul>
<li>我们可以把我们数据结构直接定义在Redis本身</li>
<li>在2.4版本之前，Redis一直使用单线程处理所有的网络请求和连接工作，在2.4之后，会导致主线层延迟比较大，又加入两个新的后台进程来辅助做auxlliary。</li>
<li>demultiplexer，并没有使用我们成熟的这类分解器，而是自己实现的</li>
<li>replication持久化和复制功能</li>
<li>Redis本身需要做一些设计的工作，不像我们只要把数据往里面存就管了</li>
<li>Redis可能还要进行数据结构的选型，比如你这个适合做一个链表结构，还是做一个集合结构等</li>
<li>还需要对内存进行预估，因为Redis是一个全内存集合，不允许部分存在内存里，部分存在磁盘上，必须对内存进行预估，否则会导致数据丢失。</li>
<li>接下来讲一下Admin所有参数，这是一个静态文件，启动前需要修改它。在运行过程中我们可以使用动态修改这些参数，其中我认为这四个是比较重要的，一个是maxmemory，限制最大内存减少，可以使用Redis使用操作系统的内存大小，提前防止出现问题。</li>
</ul>
<h1 id="redisco"><a href="#redisco" class="headerlink" title="redisco"></a>redisco</h1><ul>
<li>使用 redisco</li>
<li>redisco 可以方便操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__getattribute__</span><span class="params">(self, att)</span>:</span></div><div class="line">        <span class="keyword">if</span> att <span class="keyword">in</span> object.__getattribute__(self, <span class="string">'DELEGATEABLE_METHODS'</span>):</div><div class="line">            <span class="keyword">return</span> partial(getattr(object.__getattribute__(self, <span class="string">'db'</span>), att), self.key)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> object.__getattribute__(self, att)</div><div class="line"></div><div class="line"><span class="meta">@property</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">db</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">if</span> self.pipeline:</div><div class="line">        <span class="keyword">return</span> self.pipeline</div><div class="line">    <span class="keyword">if</span> self._db:</div><div class="line">        <span class="keyword">return</span> self._db</div><div class="line">    <span class="keyword">if</span> hasattr(self, <span class="string">'db_cache'</span>) <span class="keyword">and</span> self.db_cache:</div><div class="line">        <span class="keyword">return</span> self.db_cache</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">from</span> redisco <span class="keyword">import</span> connection</div><div class="line">        self.db_cache = connection</div><div class="line">        <span class="keyword">return</span> self.db_cache</div></pre></td></tr></table></figure>
<p>以上两个实现了 self.sadd() 这样能够调用其他对象的方法, 过程如下 :<br>self.sadd –&gt; 调用了 <strong>getattribute</strong>(self, sadd)  –&gt; 调用了 db() –&gt; 得到 redis 对象<br>                    –&gt; 取到 redis 对象的 sadd 方法<br>–&gt; 调用就成了 redis对象的 sadd 方法</p>
<h1 id="metaclass"><a href="#metaclass" class="headerlink" title="metaclass"></a><strong>metaclass</strong></h1><ol>
<li><p>你可以自由的、动态的修改/增加/删除 类的或者实例中的方法或者属性</p>
</li>
<li><p>批量的对某些方法使用decorator，而不需要每次都在方法的上面加入@decorator_func</p>
</li>
<li><p>当引入第三方库的时候，如果该库某些类需要patch的时候可以用metaclass</p>
</li>
<li><p>可以用于序列化(参见yaml这个库的实现，我没怎么仔细看）</p>
</li>
<li><p>提供接口注册，接口格式检查等</p>
</li>
<li><p>自动委托(auto delegate)</p>
</li>
<li><p>more…</p>
</li>
</ol>
<p>metaclass 的实例是 class</p>
<p>控制如何创建类</p>
<ul>
<li>在metaclass里面定义的方法会成为类的方法，可以直接通过类名来调用</li>
</ul>
<h1 id="如何使用metaclass"><a href="#如何使用metaclass" class="headerlink" title="如何使用metaclass"></a>如何使用metaclass</h1><ol>
<li><p>用类的形式</p>
<ol>
<li>类继承于type, 例如： class Meta(type):pass</li>
<li>将需要使用metaclass来构建class的类的<strong>metaclass</strong>属性（不需要显示声明，直接有的了）赋值为Meta（继承于type的类）</li>
</ol>
</li>
<li><p>用函数的形式</p>
<ol>
<li><p>构建一个函数，例如叫metaclass_new, 需要3个参数：name, bases, attrs，</p>
<p> name: 类的名字</p>
<p> bases: 基类，通常是tuple类型</p>
<p> attrs: dict类型，就是类的属性或者函数</p>
</li>
<li><p>将需要使用metaclass来构建class的类的<strong>metaclass</strong>属性（不需要显示声明，直接有的了）赋值为函数metaclas_new</p>
</li>
</ol>
</li>
</ol>
<p>定义一个类的时候就调用了 <strong>metaclass</strong>()<br>在控制台定义好类后就执行了 <strong>metaclass</strong> 里面了<br>模块中应该是载入的时候执行了<br>attrs 是类中定义的成员对象和成员方法</p>
<h1 id="metaclass-原理"><a href="#metaclass-原理" class="headerlink" title="metaclass 原理"></a>metaclass 原理</h1><p>metaclass的原理其实是这样的：当定义好类之后，创建类的时候其实是调用了type的<strong>new</strong>方法为这个类分配内存空间，创建好了之后再调用type的<strong>init</strong>方法初始化（做一些赋值等）。所以metaclass的所有magic其实就在于这个<strong>new</strong>方法里面了。</p>
<p>所以在创建类的过程，我们可以在这个函数里面修改name，bases，attrs的值来自由的达到我们的功能。这里常用的配合方法是</p>
<p>getattr和setattr（just an advice)</p>
<p>再说说关于<strong>metaclass</strong>这个属性。这个属性的说明是这样的：</p>
<p>This variable can be any callable accepting arguments for name, bases, and dict. Upon class creation, the callable is used instead of the built-in type(). New in version 2.2.(所以有了上面介绍的分别用类或者函数的方法）</p>
<p>The appropriate metaclass is determined by the following precedence rules: </p>
<p>If dict[‘<strong>metaclass</strong>‘] exists, it is used. </p>
<p>Otherwise, if there is at least one base class, its metaclass is used (this looks for a <strong>class</strong> attribute first and if not found, uses its type). </p>
<p>Otherwise, if a global variable named <strong>metaclass</strong> exists, it is used. </p>
<p>Otherwise, the old-style, classic metaclass (types.ClassType) is used. </p>
<p>这个查找顺序也比较好懂，而且利用这个顺序的话，如果是old-style类的话，可以在某个需要的模块里面指定全局变量</p>
<p><strong>metaclass</strong> = type就能把所有的old-style 变成 new-style的类了。(这是其中一种trick)</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ol>
<li>注意metaclass的<strong>new</strong>和<strong>init</strong>的区别。</li>
</ol>
<p>class DynamicMethod(type):</p>
<pre><code>def __new__(cls, name, bases, dct):  # cls=DynamicMethod

def __init__(cls, name, bases, dct): # cls=你创建的class对象
</code></pre><p>这意味着在<strong>new</strong>中我们通常只是修改dct，但是在<strong>init</strong>中，我们可以直接修</p>
<p>改创建好的类，所以我认为这两个接口的主要区别有2点：1)调用时机不同(用处请</p>
<p>发散思维)；2)<strong>init</strong>比<strong>new</strong>更有用，我在实际项目中一般都是用<strong>init</strong>的</p>
<ol>
<li>在python中我们为什么要修改class？那当然是为了改变它的行为，或者为了创</li>
</ol>
<p>建出独一无二的类。实际中常常需要为class动态添加方法。比如一个数据库表A有</p>
<p>字段name, address等，表B有name, phone等，你希望A的模型类有</p>
<p>find_by_address、find_by_name_and_address等方法，希望B的模型类有</p>
<p>find_by_name、find_by_phone等方法，但是又不想手写这些方法(其实不可能手</p>
<p>写，因为这种组合太多了)，这时你可以在A、B共同的metaclass中定义一个自动添</p>
<p>加方法的子程序，当然你也可以重写<strong>getattr</strong>之类的接口来hook所有</p>
<p>find_by_XXX函数调用，这就是时间换空间了，想象你要执行find_by_XXX一百万</p>
<p>次。也可以比较一下在c++/java中如何应对这种需求</p>
<ol>
<li>python的成功之处在于它无处不在的namespace(就是那个<strong>dict</strong>，其意义可以</li>
</ol>
<p>参考SICP第一章的environment模型，对计算理论感兴趣的也可以用lambda演算来</p>
<p>解释)，而且函数又是first class对象，又强化了interface的使用。我们知道了</p>
<p>metaclass-&gt;class-&gt;instance的关系，又知道了对象的方法是放在类里的(请详细</p>
<p>考察python查找一个方法的流程)，那么用python实现各种设计模式就比较简单了。</p>
<ol>
<li>metaclass不会使程序变晦涩，前提是了解了metaclass的固有存在，许多教程的</li>
</ol>
<p>问题就在于它没有告诉读者metaclass的存在，而是借助某些其他语言(比如c++)的</p>
<p>类模型来讲解python。在ruby的类型系统中metaclass是无限的，metaclass也有自</p>
<p>己的metaclass（你可以称之为metametaclass、metametametaclass等等），ruby</p>
<p>善于实现DSL和语法分析器也部分得益于此。</p>
<ol>
<li>不能说<strong>init</strong>比<strong>new</strong>更有用吧。我觉得要看场合。毕竟<strong>new</strong>能做到比</li>
</ol>
<p><strong>init</strong>更多的事情。比如有时候想改生成的类型名字，或者改类型的父类。:)</p>
<p>不过的确大多数场合用<strong>init</strong>就够用了。＋1</p>
<p>在<strong>init</strong>中控制类生成的过程有一点要注意：在<strong>init</strong>()的最后一个参</p>
<p>数(attrs)中，对于类中定义的函数类型的属性，比如：</p>
<p>def abc(self):</p>
<pre><code>pass
</code></pre><p>仍然具有以下的key-&gt;value形式：</p>
<p>“abc”:<function object=""></function></p>
<p>但是在生成的类中，”abc”对应的属性已经从一个function变成了一个unbind</p>
<p>method：</p>
<p>self.abc –&gt; unbind method</p>
<p>不过实际使用中影响不大</p>
<ol>
<li>哪些项目有用metaclass：</li>
</ol>
<p>据我所知就是django中的数据库部分的很多都使用metaclass来实现可描述性的</p>
<p>还有google app engine的代码里面也有使用</p>
<p>yaml中的序列化部分代码也有使用</p>
<p>more…</p>
<h1 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h1><h1 id="继承-models-保存对象"><a href="#继承-models-保存对象" class="headerlink" title="继承 models 保存对象"></a>继承 models 保存对象</h1><h1 id="TypedList-保存对象的方法也是-对象转字符串-字符串转对象"><a href="#TypedList-保存对象的方法也是-对象转字符串-字符串转对象" class="headerlink" title="TypedList 保存对象的方法也是 对象转字符串 字符串转对象"></a>TypedList 保存对象的方法也是 对象转字符串 字符串转对象</h1><h1 id="还没试验"><a href="#还没试验" class="headerlink" title="还没试验 "></a>还没试验 </h1><ul>
<li>redisco 的对象存入 list 或者 hash </li>
<li>从 list 中取到 redisco 对象</li>
</ul>
<h1 id="git"><a href="#git" class="headerlink" title="git "></a>git </h1><ul>
<li>保持用户信息<blockquote>
<p>git config –global credential.helper wincred</p>
</blockquote>
</li>
</ul>
<h1 id="python-ujson-库"><a href="#python-ujson-库" class="headerlink" title=" python ujson 库"></a> python ujson 库</h1><p> 更快一点的json库，但没有本质差别</p>
<h1 id="vscode-命令"><a href="#vscode-命令" class="headerlink" title="vscode 命令"></a>vscode 命令</h1><p>ctrl+p 打开code的命令窗口</p>
<h1 id="定时任务测试点"><a href="#定时任务测试点" class="headerlink" title="定时任务测试点 "></a>定时任务测试点 </h1><ol>
<li>创建计划，任务</li>
<li>有调用任务</li>
<li>超时处理 </li>
</ol>
<h1 id="模块"><a href="#模块" class="headerlink" title="模块 "></a>模块 </h1><h2 id="client"><a href="#client" class="headerlink" title="client"></a>client</h2><ul>
<li>send_req(request, callback)</li>
</ul>
<h2 id="request"><a href="#request" class="headerlink" title="request"></a>request</h2><ul>
<li>come_from</li>
<li>send_to</li>
<li>type</li>
<li>command</li>
<li>arg </li>
</ul>
<h2 id="roll"><a href="#roll" class="headerlink" title="roll"></a>roll</h2><ul>
<li>route</li>
<li>start</li>
<li>stop</li>
<li>heartbeat</li>
</ul>
<h2 id="rock"><a href="#rock" class="headerlink" title="rock"></a>rock</h2><ul>
<li>rock_roll</li>
<li>start_app</li>
<li>stop_app</li>
</ul>
<h1 id="管理模块"><a href="#管理模块" class="headerlink" title="管理模块"></a>管理模块</h1><ul>
<li>查看链接的应用</li>
<li>查看应用有哪些命令</li>
<li>发送命令</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/08/01/写一个简单服务框架/" data-id="cirou3vu8000wa8m3upga3sks" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-python包装c" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/29/python包装c/" class="article-date">
  <time datetime="2016-07-29T06:16:19.000Z" itemprop="datePublished">2016-07-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/29/python包装c/">python包装c++</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="c-开发python扩展"><a href="#c-开发python扩展" class="headerlink" title="c++ 开发python扩展"></a>c++ 开发python扩展</h1><h1 id="使用vs"><a href="#使用vs" class="headerlink" title="使用vs"></a>使用vs</h1><ol>
<li>创建一个VS的Dll工程</li>
<li>按照Python扩展的写法添加代码</li>
<li>包含python头文件和libs目录</li>
<li>dll的扩展名改为pyd</li>
<li>因为我们装的python是Release版的，因此这个扩展也只能用Release生成，否则有链接错误。</li>
<li>python 和 c++ 扩展的混合调试</li>
</ol>
<h1 id="python-manual"><a href="#python-manual" class="headerlink" title="python manual"></a>python manual</h1><blockquote>
<p>Do note that if your use case is calling C library functions or system calls,<br>只是要调用动态库或者是系统调用<br>you should consider using the <code>ctypes</code> module rather than writing custom C code.<br>使用  <code>ctypes</code> 模块就行了，不需要写扩展<br>Not only does ctypes let you write Python code to interface with C code,<br>but it is more portable between implementations of Python than writing and compiling an extension module which typically ties you to CPython.<br><code>ctypes</code>的兼容性更好</p>
<p>一个C++的Python扩展模块至少应该有导出函数，方法列表和初始化函数三个部分</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 功能        : 初始化函数</span></div><div class="line"><span class="comment">// 返回值     :PyMODINIT_FUNC</span></div><div class="line"><span class="comment">// 必须是init+模块名字</span></div><div class="line"><span class="comment">// 我们的模块名字是 _KSApi_Md ，所以函数名是 init_KSApi_Md</span></div><div class="line"><span class="comment">// Python在导入 我们的 _KSApi_Md 模块时，会找到这个函数，并调用。</span></div><div class="line"><span class="comment">// 这个函数实现的功能很简单，通过调用Py_InitModule将模块名字和映射表结合起来，</span></div><div class="line"><span class="comment">// 它的意思是说PyExt这个模块使用PyExtMethods这个映射表。</span></div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="function">MD_API_EXPORT <span class="keyword">void</span> <span class="title">init_KSApi_Md</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> PyMethodDef mbMethods[] = &#123;</div><div class="line">    <span class="comment">/*</span></div><div class="line"></div><div class="line">      方法列表，这个是一个C结构数组。把需要扩展的函数都映射到这个表里。</div><div class="line"></div><div class="line">      那么Python就知道你的这个扩展模块支持一些什么方法了。表的第一个字</div><div class="line"></div><div class="line">      段是方法名字，也是通过Python来调用时的名字。第二个字段是导出函数，</div><div class="line"></div><div class="line">      是真正调用的函数，也是C\C++实现的函数。第三个参数是指明Python向</div><div class="line"></div><div class="line">      C\C++函数传递参数的形式。可选的两种方式是METH_VARARGS和</div><div class="line"></div><div class="line">      METH_KEYWORDS，其中METH_VARARGS是参数传递的标准形式，它通</div><div class="line"></div><div class="line">      过Python的元组在Python解释器和C函数之间传递参数，若采用</div><div class="line"></div><div class="line">      METH_KEYWORD方式，则Python解释器和C函数之间将通过Python的字典</div><div class="line"></div><div class="line">      类型在两者之间进行参数传递。第四个字段是这个函数的说明。如果你在</div><div class="line"></div><div class="line">      python里来help这个函数，将显示这个说明。相当于在python里的函数的文档说明。</div><div class="line"></div><div class="line">    */</div><div class="line">     &#123;<span class="string">"create_KSMdApi"</span>, create_KSMdApi, METH_VARARGS&#125;,</div><div class="line">     &#123;<span class="string">"register_struct"</span>, register_struct, METH_VARARGS&#125;,</div><div class="line"></div><div class="line">     &#123;<span class="string">"ReqUserLogout"</span>, Md_ReqUserLogout, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"Join"</span>, Md_Join, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"RegisterNameServer"</span>, Md_RegisterNameServer, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"UnSubscribeMarketData"</span>, Md_UnSubscribeMarketData, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"SetWritablePath"</span>, Md_SetWritablePath, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"RegisterFront"</span>, Md_RegisterFront, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"Init"</span>, Md_Init, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"ReqUserLogin"</span>, Md_ReqUserLogin, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"Release"</span>, Md_Release, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"GetTradingDay"</span>, Md_GetTradingDay, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"SubscribeMarketData"</span>, Md_SubscribeMarketData, METH_VARARGS&#125; ,</div><div class="line">     &#123;<span class="string">"RegisterSpi"</span>, Md_RegisterSpi, METH_VARARGS&#125; ,</div><div class="line"></div><div class="line">     &#123;<span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>&#125; </div><div class="line">   &#125;;</div><div class="line"></div><div class="line">   PyObject *m = Py_InitModule(<span class="string">"_KSApi_Md"</span>, mbMethods);</div><div class="line"></div><div class="line">   PyEval_InitThreads();</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//-------------------------------------------------------------------------</span></div><div class="line"></div><div class="line"><span class="comment">// 函数        : Add</span></div><div class="line"></div><div class="line"><span class="comment">// 功能        : 这是一个加法函数</span></div><div class="line"></div><div class="line"><span class="comment">// 返回值     :PyObject*</span></div><div class="line"></div><div class="line"><span class="comment">// 参数        : PyObject*self 这个参数我们暂时不用理会</span></div><div class="line"></div><div class="line"><span class="comment">// 参数        : PyObject*args 是一个参数列表，我们需要从它解析出参数</span></div><div class="line"></div><div class="line"><span class="comment">// 附注        :</span></div><div class="line"></div><div class="line"><span class="comment">// 所有的导出函数都具有相同的原型：</span></div><div class="line"></div><div class="line"><span class="comment">// PyObject*method(PyObject* self, PyObject* args);</span></div><div class="line"></div><div class="line"><span class="comment">//PyArg_ParseTuple来完成解析参数任务。它的第一个参数是args，</span></div><div class="line"></div><div class="line"><span class="comment">// 就是我们要转换的参数。第二个是格式符号。"s"代表是个string。</span></div><div class="line"></div><div class="line"><span class="comment">// 从args里提取一个参数就写"s"，两个的话就写"s|s"，如果是一个</span></div><div class="line"></div><div class="line"><span class="comment">// string，一个int，就写"s|i"，有点和printf类似哦。第三个参数就是</span></div><div class="line"></div><div class="line"><span class="comment">// 提取出来的参数放置的真正位置。必须传递这个参数的地址。</span></div><div class="line"></div><div class="line"><span class="comment">//-------------------------------------------------------------------------</span></div><div class="line"></div><div class="line"><span class="function">staticPyObject*<span class="title">Add</span><span class="params">(PyObject*self,PyObject*args)</span></span></div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">       intx = <span class="number">0</span> ;</div><div class="line"></div><div class="line">       inty = <span class="number">0</span>;</div><div class="line"></div><div class="line">       intz = <span class="number">0</span>;</div><div class="line"></div><div class="line">       <span class="keyword">if</span>(!PyArg_ParseTuple(args,<span class="string">"i|i"</span>, &amp;x, &amp;y))</div><div class="line"></div><div class="line">             returnNULL;</div><div class="line"></div><div class="line">       z=x +y;</div><div class="line"></div><div class="line">       returnPy_BuildValue(<span class="string">"i"</span>,z);</div><div class="line"></div><div class="line">       <span class="comment">/*</span></div><div class="line"></div><div class="line">            调用完之后我们需要返回结果。这个结果是c的type或者是我们自己定义的类型。</div><div class="line"></div><div class="line">            必须把他转换成PyObject，让python认识。这个用Py_BuildValue来完成。他</div><div class="line"></div><div class="line">            是PyArg_ParseTuple的逆过程。他的第一个参数和PyArg_ParseTuple的第二个</div><div class="line"></div><div class="line">            参数一样，是个格式化符号。第三个参数是我们需要转换的参数。Py_BuildValue</div><div class="line"></div><div class="line">            会把所有的返回只组装成一个tutple给python。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">            如果对应的C函数没有返回值（即返回值类型为void），则应返回一个全局的None</div><div class="line"></div><div class="line">            对象(Py_None)，并将其引用计数增，如下所示：</div><div class="line"></div><div class="line">            Py_INCREF(Py_None);</div><div class="line"></div><div class="line">            returnPy_None;</div><div class="line"></div><div class="line">      */</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在c++中操作 pyobj 使用 <code>PyObject_CallMethod</code> 等函数    </p>
<p>解析 c++接口的头文件 生成 得到 python 模块文件和 c++ 的包装代码 以及 c++ 结构体转 python 对象的 c++ 代码  </p>
<h1 id="写"><a href="#写" class="headerlink" title="写"></a>写</h1><ul>
<li><p>首先创建一个VS的Dll工程PyExt，再按照Python扩展的写法添加代码：</p>
</li>
<li><p>c++ 的过程是 </p>
<pre><code>1. 定义 spi派生类
2. 调用 api 的 注册回调, init等方法
3. 在事件发生后回调被执行
</code></pre></li>
<li><p>包装成python的动态库过程 </p>
<pre><code>1. 定义spi 用于调用python的spi对象, 如 连接建立 -&gt;  c++的回调 -&gt; python 的回调 ( c++调用python对象)
2. 封装的python函数都去执行关联的c++函数
3. 定义一些python对象转成c++结构体的方法在c++调用python时的传参
</code></pre></li>
</ul>
<p>2.3 数据类型</p>
<p>Python定义了六种数据类型：整型、浮点型、字符串、元组、列表和字典，在使用C语言对Python进行功能扩展时，首先要了解如何在C和Python的数据类型间进行转化。</p>
<p>2.3.1 整型、浮点型和字符串</p>
<p>在Python的C语言扩展中要用到整型、浮点型和字符串这三种数据类型时相对比较简单，只需要知道如何生成和维护它们就可以了。下面的例子给出了如何在C语言中使用Python的这三种数据类型：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">例<span class="number">2</span>：typeifs.c</div><div class="line"><span class="comment">// build an integer</span></div><div class="line">PyObject* pInt = Py_BuildValue(<span class="string">"i"</span>, <span class="number">2003</span>);</div><div class="line"><span class="keyword">assert</span>(PyInt_Check(pInt));</div><div class="line"><span class="keyword">int</span> i = PyInt_AsLong(pInt);</div><div class="line">Py_DECREF(pInt);</div><div class="line"><span class="comment">// build a float</span></div><div class="line">PyObject* pFloat = Py_BuildValue(<span class="string">"f"</span>, <span class="number">3.14</span>f);</div><div class="line"><span class="keyword">assert</span>(PyFloat_Check(pFloat));</div><div class="line"><span class="keyword">float</span> f = PyFloat_AsDouble(pFloat);</div><div class="line">Py_DECREF(pFloat);</div><div class="line"><span class="comment">// build a string</span></div><div class="line">PyObject* pString = Py_BuildValue(<span class="string">"s"</span>, <span class="string">"Python"</span>);</div><div class="line"><span class="keyword">assert</span>(PyString_Check(pString);</div><div class="line"><span class="keyword">int</span> nLen = PyString_Size(pString);</div><div class="line"><span class="keyword">char</span>* s = PyString_AsString(pString);</div><div class="line">Py_DECREF(pString);</div></pre></td></tr></table></figure>
<p>2.3.2 元组</p>
<p>Python语言中的元组是一个长度固定的数组，当Python解释器调用C语言扩展中的方法时，所有非关键字(non-keyword)参数都以元组方式进行传递。下面的例子示范了如何在C语言中使用Python的元组类型</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">例<span class="number">3</span>：typetuple.c</div><div class="line"><span class="comment">// create the tuple</span></div><div class="line">PyObject* pTuple = PyTuple_New(<span class="number">3</span>);</div><div class="line">assert(PyTuple_Check(pTuple));</div><div class="line">assert(PyTuple_Size(pTuple) == <span class="number">3</span>);</div><div class="line"><span class="comment">// set the item</span></div><div class="line">PyTuple_SetItem(pTuple, <span class="number">0</span>, Py_BuildValue(<span class="string">"i"</span>, <span class="number">2003</span>));</div><div class="line">PyTuple_SetItem(pTuple, <span class="number">1</span>, Py_BuildValue(<span class="string">"f"</span>, <span class="number">3.14</span>f));</div><div class="line">PyTuple_SetItem(pTuple, <span class="number">2</span>, Py_BuildValue(<span class="string">"s"</span>, <span class="string">"Python"</span>));</div><div class="line"><span class="comment">// parse tuple items</span></div><div class="line">int i;</div><div class="line"><span class="type">float</span> f;</div><div class="line">char *s;</div><div class="line">if (!PyArg_ParseTuple(pTuple, <span class="string">"ifs"</span>, &amp;i, &amp;f, &amp;s))</div><div class="line">    PyErr_SetString(PyExc_TypeError, <span class="string">"invalid parameter"</span>);</div><div class="line"><span class="comment">// cleanup</span></div><div class="line">Py_DECREF(pTuple);</div></pre></td></tr></table></figure>
<p>2.3.4 字典</p>
<p>Python语言中的字典是一个根据关键字进行访问的数据类型。下面的例子示范了如何在C语言中使用Python的字典类型：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">例<span class="number">5</span>：typedic.c</div><div class="line"><span class="comment">// create the dictionary</span></div><div class="line">PyObject* pDict = PyDict_New(); <span class="comment">// new reference</span></div><div class="line"><span class="keyword">assert</span>(PyDict_Check(pDict));</div><div class="line"><span class="comment">// add a few named values</span></div><div class="line">PyDict_SetItemString(pDict, <span class="string">"first"</span>, </div><div class="line">                     Py_BuildValue(<span class="string">"i"</span>, <span class="number">2003</span>));</div><div class="line">PyDict_SetItemString(pDict, <span class="string">"second"</span>, </div><div class="line">                     Py_BuildValue(<span class="string">"f"</span>, <span class="number">3.14</span>f));</div><div class="line"><span class="comment">// enumerate all named values</span></div><div class="line">PyObject* pKeys = PyDict_Keys(); <span class="comment">// new reference</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; PyList_Size(pKeys); ++i) &#123;</div><div class="line">  PyObject *pKey = PyList_GetItem(pKeys, i);</div><div class="line">  PyObject *pValue = PyDict_GetItem(pDict, pKey);</div><div class="line">  <span class="keyword">assert</span>(pValue);</div><div class="line">&#125;</div><div class="line">Py_DECREF(pKeys);</div><div class="line"><span class="comment">// remove a named value</span></div><div class="line">PyDict_DelItemString(pDict, <span class="string">"second"</span>);</div><div class="line"><span class="comment">// cleanup</span></div><div class="line">Py_DECREF(pDict);</div></pre></td></tr></table></figure>
<h1 id="bat"><a href="#bat" class="headerlink" title="bat "></a>bat </h1><ol>
<li>if exist d:\test.txt (echo D盘下有test.txt存在) else (echo D盘下不存在test.txt) </li>
<li>if “abc”==”xyz” (echo 字符串abc等于字符串xyz) else (echo 字符串abc不等于字符串xyz) </li>
<li>if 1 equ 2 (echo 1等于2) else (echo 1不等于2) </li>
<li>if defined str (echo 变量str已经被赋值，其值为%str%) else (echo 变量str的值为空) </li>
</ol>
<h1 id="python"><a href="#python" class="headerlink" title="python"></a>python</h1><p>定义的参数可以用 , 结尾<br>def fun(a, )<br>      return ‘ffo’</p>
<p>此处 fun 只接受一个参数</p>
<p>Python中所有加载到内存的模块都放在 sys.modules 。当 import 一个模块时首先会在这个列表中查找是否已经加载了此模块，如果加载了则只是将模块的名字加入到正在调用 import 的模块的 Local 名字空间中。如果没有加载则从 sys.path 目录中按照模块名称查找模块文件，模块可以是py、pyc、pyd，找到后将模块载入内存，并加到 sys.modules 中，并将名称导入到当前的 Local 名字空间。</p>
<p>import 只能导入模块，不能导入模块中的对象（类、函数、变量等）。例如：模块 A（A.py）中有个函数 getName，另一个模块不能通过 import A.getName 将 getName导入到本模块，只能用 from A import getName</p>
<p>只要一个文件夹下面有个 <strong>init</strong>.py 文件，那么这个文件夹就可以看做是一个包。包导入的过程和模块的基本一致，只是导入包的时候会执行此包目录下的 <strong>init</strong>.py 而不是模块里面的语句了。另外，如果只是单纯的导入包，而包的 <strong>init</strong>.py 中又没有明确的其他初始化操作，那么此包下面的模块是不会自动导入的。</p>
<p>使用Python import 模块时，</p>
<p>先会在模块的搜索path里依次搜索（前面会覆盖之后出现的同名模块），次序为： </p>
<ol>
<li><p>程序的主目录（交互模式下当前的工作目录或 脚本文件所在的目录）</p>
</li>
<li><p>环境变量 PYTHONPATH目录（如果已经进行了设置）</p>
</li>
<li><p>标准链接库目录（标准库模块所在目录 C:\Python27或C:\Python27\Lib\site-packages 目录中）</p>
</li>
<li><p>任何放在标准链接库目录中的.pth文件中记录的目录</p>
<p>.pyd 文件（Python中的动态链接库文件），</p>
</li>
</ol>
<ul>
<li>得到字典, 所有的key的value都一样<br>dict.fromkeys([keys, …], value)</li>
</ul>
<p>types模块定义了python中所有的类型</p>
<p>types ModuleType 动态创建模块</p>
<p>types MethodType 动态创建属性</p>
<h1 id="redis-redis-lua"><a href="#redis-redis-lua" class="headerlink" title="redis redis + lua"></a>redis redis + lua</h1><h1 id="BASIC-KEY-COMMANDS"><a href="#BASIC-KEY-COMMANDS" class="headerlink" title="BASIC KEY COMMANDS"></a>BASIC KEY COMMANDS</h1><p>append<br>bitcount<br>bitop<br>bitpos<br>decr<br>delete<br>dump<br>exists<br>expire<br>expireat<br>get<br>getbit<br>getrange<br>getset<br>incr<br>incrby<br>incrbyfloat<br>keys<br>mget<br>mset<br>msetnx<br>move<br>persist<br>pexpire<br>pexpireat<br>psetex<br>pttl<br>randomkey<br>rename<br>renamenx<br>restore<br>set<br>setbit<br>setex<br>setnx<br>setrange<br>strlen<br>substr<br>ttl<br>type<br>watch<br>unwatch</p>
<h1 id="LIST-COMMANDS"><a href="#LIST-COMMANDS" class="headerlink" title="LIST COMMANDS"></a>LIST COMMANDS</h1><p>blpop<br>brpop<br>brpoplpush<br>lindex<br>linsert<br>llen<br>lpop<br>lpush<br>lpushx<br>lrange<br>lrem<br>lset<br>ltrim<br>rpop<br>rpoplpush<br>rpush<br>rpushx<br>sort</p>
<h1 id="SCAN-COMMANDS"><a href="#SCAN-COMMANDS" class="headerlink" title="SCAN COMMANDS"></a>SCAN COMMANDS</h1><p>;python 中特有的<br>scan<br>scan_iter<br>hscan<br>hscan_iter<br>zscan<br>zscan_iter</p>
<h1 id="SET-COMMANDS"><a href="#SET-COMMANDS" class="headerlink" title="SET COMMANDS"></a>SET COMMANDS</h1><p>sadd<br>scard<br>sdiff<br>sdiffstore<br>sinter<br>sismember<br>smembers<br>smove<br>spop<br>srandmember<br>srem<br>sunion<br>sunionstore</p>
<h1 id="SORTED-SET-COMMANDS"><a href="#SORTED-SET-COMMANDS" class="headerlink" title="SORTED SET COMMANDS"></a>SORTED SET COMMANDS</h1><p>zadd  –&gt; 根据加权值排序的, name1=score1, name2=score2<br>zcard<br>zcount<br>zincrby<br>zinterstore<br>zlexcount<br>zrange<br>zrangebylex<br>zrevrangebylex<br>zrangebyscore<br>zrank<br>zrem<br>zremrangebylex<br>zremrangebyrank<br>zremrangebyscore<br>zrevrange<br>zrevrangebyscore<br>zrevrank<br>zscore<br>zunionstore</p>
<h1 id="HYPERLOGLOG-COMMANDS"><a href="#HYPERLOGLOG-COMMANDS" class="headerlink" title="HYPERLOGLOG COMMANDS"></a>HYPERLOGLOG COMMANDS</h1><p>pfadd<br>pfcount<br>pfmerge</p>
<h1 id="HASH-COMMANDS"><a href="#HASH-COMMANDS" class="headerlink" title="HASH COMMANDS"></a>HASH COMMANDS</h1><p>hdel<br>hexists<br>hget<br>hgetall<br>hincrby<br>hincrbyfloat<br>hkeys<br>hlen<br>hset  –&gt; 要分别指定 key 和value<br>hsetnx<br>hmset –&gt; 传入map对象, 相当于循环调用hset<br>hmget<br>hvals<br>publish<br>eval<br>evalsha<br>script_exists<br>script_flush<br>script_kill<br>script_load<br>register_script</p>
<h1 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h1><p>管道</p>
<p>管道是Redis的子类，它支持缓冲多个命令，一次性发送到服务器去执行。可以大大的提高性能，减少服务器到客户端之间的TCP来回数据包。</p>
<p>pipe.set(‘foo’, ‘bar’).sadd(‘faz’, ‘baz’).incr(‘auto_number’).execute()</p>
<h1 id="transaction"><a href="#transaction" class="headerlink" title="transaction"></a>transaction</h1><h1 id="lock"><a href="#lock" class="headerlink" title="lock"></a>lock</h1><h1 id="pubsub"><a href="#pubsub" class="headerlink" title="pubsub"></a>pubsub</h1><h1 id="COMMAND-EXECUTION-AND-PROTOCOL-PARSING"><a href="#COMMAND-EXECUTION-AND-PROTOCOL-PARSING" class="headerlink" title="COMMAND EXECUTION AND PROTOCOL PARSING"></a>COMMAND EXECUTION AND PROTOCOL PARSING</h1><p>execute_command<br>parse_response</p>
<h1 id="SERVER-INFORMATION"><a href="#SERVER-INFORMATION" class="headerlink" title="SERVER INFORMATION"></a>SERVER INFORMATION</h1><p>bgrewriteaof<br>bgsave      –&gt; 异步的保存数据到硬盘<br>client_kill<br>client_list<br>client_getname<br>client_setname<br>config_get<br>config_set<br>config_resetstat<br>config_rewrite<br>dbsize      –&gt; #库里有多少key，多少条数据<br>debug_object<br>echo<br>flushall<br>flushdb     –&gt; #删除当前数据库的所有数据<br>info<br>lastsave<br>object<br>ping<br>save  –&gt; #强行把数据库保存到硬盘。保存时阻塞<br>sentinel<br>sentinel_get_master_addr_by_name<br>sentinel_master<br>sentinel_masters<br>sentinel_monitor<br>sentinel_remove<br>sentinel_sentinels<br>sentinel_set<br>sentinel_slaves<br>shutdown<br>slaveof<br>slowlog_get<br>slowlog_len<br>slowlog_reset<br>time<br>wait</p>
<h1 id="2016年7月31日"><a href="#2016年7月31日" class="headerlink" title="2016年7月31日"></a>2016年7月31日</h1><ol>
<li>搭建银河行情</li>
<li>搭建银河下单</li>
</ol>
<h1 id="理解-declspec-dllexport-和declspec-dllimport"><a href="#理解-declspec-dllexport-和declspec-dllimport" class="headerlink" title="理解 declspec(dllexport)和declspec(dllimport)"></a>理解 <strong>declspec(dllexport)和</strong>declspec(dllimport)</h1><p>1、解决的问题：</p>
<p>　　考虑下面的需求，使用一个方法，一个是提供者，一个是使用者，二者之间的接口是头文件。头文件中声明了方法，在提供者那里方法应该被声明为<strong>declspec(dllexport)，在使用者那里，方法应该被声明为</strong>declspec(dllimport)。二者使用同一个头文件，作为接口，怎么办呢？</p>
<p>2、解决办法：</p>
<p>　　使用条件编译：定义一个变量，针对提供者和使用者，设置不同的值。<br>复制代码</p>
<p> 1 #ifndef DLL<em>H</em><br> 2 #define DLL<em>H</em><br> 3<br> 4 #ifdef DLLProvider<br> 5 #define DLL_EXPORT_IMPORT <strong>declspec(dllexport)<br> 6 #else<br> 7 #define DLL_EXPORT_IMPORT </strong>declspec(dllimport)<br> 8 #endif<br> 9<br>10 DLL_EXPORT_IMPORT int add(int ,int);<br>11<br>12 #endif</p>
<h1 id="wsgi"><a href="#wsgi" class="headerlink" title="wsgi"></a>wsgi</h1><p>WSGI接口定义非常简单，它只要求Web开发者实现一个函数，就可以响应HTTP请求。我们来看一个最简单的Web版本的“Hello, web!”：</p>
<p>def application(environ, start_response):<br>    start_response(‘200 OK’, [(‘Content-Type’, ‘text/html’)])<br>    return ‘</p><h1>Hello, web!</h1>‘<p></p>
<p>上面的application()函数就是符合WSGI标准的一个HTTP处理函数，它接收两个参数：</p>
<pre><code>environ：一个包含所有HTTP请求信息的dict对象；

start_response：一个发送HTTP响应的函数。
</code></pre><p>在application()函数中，调用：</p>
<p>start_response(‘200 OK’, [(‘Content-Type’, ‘text/html’)])</p>
<p>就发送了HTTP响应的Header，注意Header只能发送一次，也就是只能调用一次start_response()函数。start_response()函数接收两个参数，一个是HTTP响应码，一个是一组list表示的HTTP Header，每个Header用一个包含两个str的tuple表示。</p>
<h1 id="collections是Python内建的一个集合模块，提供了许多有用的集合类"><a href="#collections是Python内建的一个集合模块，提供了许多有用的集合类" class="headerlink" title="collections是Python内建的一个集合模块，提供了许多有用的集合类"></a>collections是Python内建的一个集合模块，提供了许多有用的集合类</h1><h1 id="namedtuple"><a href="#namedtuple" class="headerlink" title="namedtuple"></a>namedtuple</h1><p>namedtuple是一个函数，它用来创建一个自定义的tuple对象，并且规定了tuple元素的个数，并可以用属性而不是索引来引用tuple的某个元素。</p>
<p>这样一来，我们用namedtuple可以很方便地定义一种数据类型，它具备tuple的不变性，又可以根据属性来引用，使用十分方便。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;</span>&gt; from collections import namedtuple</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; Point = namedtuple(<span class="string">'Point'</span>, [<span class="string">'x'</span>, <span class="string">'y'</span>])</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; p = Point(<span class="number">1</span>, <span class="number">2</span>)</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; p.x</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; p.y</div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure></p>
<h1 id="deque"><a href="#deque" class="headerlink" title="deque"></a>deque</h1><p>使用list存储数据时，按索引访问元素很快，但是插入和删除元素就很慢了，因为list是线性存储，数据量大的时候，插入和删除效率很低。</p>
<p>deque是为了高效实现插入和删除操作的双向列表，适合用于队列和栈：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from collections import deque</div><div class="line">&gt;&gt;&gt; <span class="selector-tag">q</span> = deque([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])</div><div class="line">&gt;&gt;&gt; <span class="selector-tag">q</span>.append(<span class="string">'x'</span>)</div><div class="line">&gt;&gt;&gt; <span class="selector-tag">q</span>.appendleft(<span class="string">'y'</span>)</div><div class="line">&gt;&gt;&gt; <span class="selector-tag">q</span></div><div class="line"><span class="function"><span class="title">deque</span><span class="params">([<span class="string">'y'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'x'</span>])</span></span></div></pre></td></tr></table></figure></p>
<h1 id="defaultdict"><a href="#defaultdict" class="headerlink" title="defaultdict"></a>defaultdict</h1><p>使用dict时，如果引用的Key不存在，就会抛出KeyError。如果希望key不存在时，返回一个默认值，就可以用defaultdict：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;</span>&gt; from collections import defaultdict</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; dd = defaultdict(<span class="symbol">lambda:</span> <span class="string">'N/A'</span>)</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; dd[<span class="string">'key1'</span>] = <span class="string">'abc'</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; dd[<span class="string">'key1'</span>] <span class="comment"># key1存在</span></div><div class="line"><span class="string">'abc'</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; dd[<span class="string">'key2'</span>] <span class="comment"># key2不存在，返回默认值</span></div><div class="line"><span class="string">'N/A</span></div></pre></td></tr></table></figure>
<h1 id="OrderedDict"><a href="#OrderedDict" class="headerlink" title="OrderedDict"></a>OrderedDict</h1><p>使用dict时，Key是无序的。在对dict做迭代时，我们无法确定Key的顺序。</p>
<p>如果要保持Key的顺序，可以用OrderedDict：</p>
<p>注意，OrderedDict的Key会按照插入的顺序排列，不是Key本身排序：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;</span>&gt; from collections import OrderedDict</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; d = dict([(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">3</span>)])</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; d <span class="comment"># dict的Key是无序的</span></div><div class="line">&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'b'</span>: <span class="number">2</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; od = OrderedDict([(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">3</span>)])</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; od <span class="comment"># OrderedDict的Key是有序的</span></div><div class="line">OrderedDict([(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">3</span>)])</div></pre></td></tr></table></figure>
<p>OrderedDict可以实现一个FIFO（先进先出）的dict，当容量超出限制时，先删除最早添加的Key：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LastUpdatedOrderedDict</span><span class="params">(OrderedDict)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, capacity)</span>:</span></div><div class="line">        super(LastUpdatedOrderedDict, self).__init__()</div><div class="line">        self._capacity = capacity</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setitem__</span><span class="params">(self, key, value)</span>:</span></div><div class="line">        containsKey = <span class="number">1</span> <span class="keyword">if</span> key <span class="keyword">in</span> self <span class="keyword">else</span> <span class="number">0</span></div><div class="line">        <span class="keyword">if</span> len(self) - containsKey &gt;= self._capacity:</div><div class="line">            last = self.popitem(last=<span class="keyword">False</span>)</div><div class="line">            <span class="keyword">print</span> <span class="string">'remove:'</span>, last</div><div class="line">        <span class="keyword">if</span> containsKey:</div><div class="line">            <span class="keyword">del</span> self[key]</div><div class="line">            <span class="keyword">print</span> <span class="string">'set:'</span>, (key, value)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">'add:'</span>, (key, value)</div><div class="line">        OrderedDict.__setitem__(self, key, value)</div></pre></td></tr></table></figure></p>
<h1 id="Counter"><a href="#Counter" class="headerlink" title="Counter"></a>Counter</h1><p>Counter是一个简单的计数器，例如，统计字符出现的个数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> ch <span class="keyword">in</span> <span class="string">'programming'</span>:</div><div class="line"><span class="meta">... </span>    c[ch] = c[ch] + <span class="number">1</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'g'</span>: <span class="number">2</span>, <span class="string">'m'</span>: <span class="number">2</span>, <span class="string">'r'</span>: <span class="number">2</span>, <span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'i'</span>: <span class="number">1</span>, <span class="string">'o'</span>: <span class="number">1</span>, <span class="string">'n'</span>: <span class="number">1</span>, <span class="string">'p'</span>: <span class="number">1</span>&#125;)</div></pre></td></tr></table></figure>
<h1 id="functools-模块"><a href="#functools-模块" class="headerlink" title="functools 模块"></a>functools 模块</h1><h1 id="partial"><a href="#partial" class="headerlink" title="partial"></a>partial</h1><p>partial 函数，它可以重新绑定函数的可选参数，生成一个callable的partial对象：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">int</span><span class="params">(<span class="string">'10'</span>, base=<span class="number">2</span>)</span></span></div><div class="line">int2 = partial(int, base=<span class="number">2</span>)</div><div class="line"><span class="function"><span class="title">int2</span><span class="params">(<span class="string">'10'</span>)</span></span></div></pre></td></tr></table></figure></p>
<h1 id="update-wrapper"><a href="#update-wrapper" class="headerlink" title="update_wrapper"></a>update_wrapper</h1><p>update_wrapper 函数，它可以把被封装函数的<code>__name__</code>、<code>__module__</code>、<code>__doc__</code>和 <code>__dict__</code>都复制到封装函数去：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">update_wrapper</span><span class="params">(fun_dis, fun_from)</span></span></div></pre></td></tr></table></figure>
<h1 id="wraps"><a href="#wraps" class="headerlink" title="wraps"></a>wraps</h1><p>wraps 函数，它将update_wrapper也封装了进来：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@wraps(fun_from)</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun_dis</span><span class="params">()</span>:</span></div><div class="line">      <span class="keyword">pass</span></div><div class="line">``` </div><div class="line"></div><div class="line"></div><div class="line">pdb</div><div class="line">==========================</div><div class="line"><span class="number">1.</span> 用pdb调试有多种方式可选</div><div class="line">python -m pdb myscript.py</div><div class="line"></div><div class="line"><span class="number">2.</span> 在Python交互环境中启用调试</div></pre></td></tr></table></figure></p>
<blockquote>
<blockquote>
<blockquote>
<p>import pdb<br>import mymodule<br>pdb.run(‘mymodule.test()’)<br><figure class="highlight d"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="number">3.</span> 比较常用的，就是在程序中间插入一段程序，相对于在一般IDE里面打上断点然后启动<span class="keyword">debug</span>，不过这种方式是hardcode的</div></pre></td></tr></table></figure></p>
</blockquote>
</blockquote>
</blockquote>
<p>if <strong>name</strong> == “<strong>main</strong>“:<br>    a = 1<br>    import pdb<br>    pdb.set_trace()<br>    b = 2<br>    c = a + b<br>    print (c)<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="asciidoc"><span class="section">性能分析 cProfile</span></span></div><div class="line">===========</div></pre></td></tr></table></figure></p>
<h1 id="cprof-example-py"><a href="#cprof-example-py" class="headerlink" title="cprof_example.py"></a>cprof_example.py</h1><p>import numpy as np<br>from numpy.linalg import eigvals</p>
<p>def run<em>experiment(niter=100):<br>    k = 100<br>    results = []<br>    for </em> in xrange(niter):<br>        mat = np.random.randn(k, k)<br>        max_eigenvalue = np.abs(eigvals(mat)).max()<br>        results.append(max_eigenvalue)<br>    return results<br>some_resules = run_experiment()<br>print ‘largest one we saw  %s’ % np.max(some_resules)<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">`python -m cProfile cprof_example.py`</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">ipython notebook</div><div class="line">==============</div><div class="line"></div><div class="line">jupyter（原来的notebook） </div><div class="line"></div><div class="line"></div><div class="line">IPython Notebook使用浏览器作为界面，向后台的IPython服务器发送请求，并显示结果。在浏览器的界面中使用单元(Cell)保存各种信息。Cell有多种类型，经常使用的有表示格式化文本的Markdown单元，和表示代码的Code单元。</div><div class="line"></div><div class="line">每个代码单元都有一个输出区域，在Code单元中输入代码，按 Shift-Enter 将运行此代码，代码中最后一个表达式的值将输出区域显示。如果希望屏蔽输出，可以在最后一条语句之后添加一个分号：”;”。此外，代码中还可以使用<span class="built_in">print</span>语句在输出区域中显示信息。</div><div class="line"></div><div class="line">在Markdown单元中还可以直接使用Html和Javascript。</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 数学公式</span></div><div class="line"></div><div class="line">在Markdown单元中可以使用LaTeX表示数学公式，例如<span class="string">\sqrt&#123;x^2+y^2&#125;。数学公式的显示使用MathJax，缺省情况下，MathJax从网络上下载，如果希望离线使用它，需要在IPython</span> Notebook中输入如下代码，把MathJax安装到本地磁盘中：</div><div class="line"></div><div class="line"><span class="keyword">from</span> IPython.external.mathjax <span class="keyword">import</span> install_mathjax</div><div class="line">install_mathjax()</div><div class="line"></div><div class="line">Code单元的输出也可以显示为数学公式，例如在单元中输入如下代码，将显示为数学公式：</div><div class="line"></div><div class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Latex</div><div class="line">Latex(r<span class="string">"$\sqrt&#123;x^2+y^2&#125;$"</span>)</div><div class="line"></div><div class="line">SymPy的表达式也可以显示为LaTex，例如：</div><div class="line"></div><div class="line">%load_ext sympyprinting</div><div class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</div><div class="line">x, y = symbols(<span class="string">"x,y"</span>)</div><div class="line">sqrt(x**<span class="number">2</span>+y**<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="string">\sqrt&#123;x^&#123;2&#125;</span> + y^&#123;<span class="number">2</span>&#125;&#125;</div><div class="line"></div><div class="line">以%开头的为IPython的命令(Magic Command)，这里通过%load_ext命令载入sympyprinting扩展插件，载入此插件之后，所有的SymPy表达式都显示为数学公式。</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 各种显示</span></div><div class="line"></div><div class="line">IPython.display模块中提供了许多显示Python返回值的类，例如下面的代码用Image类显示”python.png”图片，缺省路径为Notebook文件所在的目录：</div><div class="line"></div><div class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Image</div><div class="line">Image(filename=<span class="string">"python.png"</span>)</div><div class="line"></div><div class="line">Image还可以用来显示表示图像的字符串。例如下面的代码通过cv2的imencode()将NumPy数组转换为一个表示PNG图像数据的数组，然后将此数组转换为字符串之后通过Image()将显示为图像：</div><div class="line"></div><div class="line"><span class="keyword">import</span> cv2</div><div class="line"><span class="keyword">import</span> numpy as np</div><div class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Image</div><div class="line">img = np.random.randint(<span class="number">0</span>,<span class="number">255</span>,(<span class="number">250</span>,<span class="number">250</span>,<span class="number">3</span>))</div><div class="line">cv2.blur(img, (<span class="number">11</span>,<span class="number">11</span>), img)</div><div class="line">r, dat = cv2.imencode(<span class="string">".png"</span>,img)</div><div class="line">Image(dat.tostring())</div><div class="line"></div><div class="line">opencv_image.png</div><div class="line"></div><div class="line">此外，还可以通过HTML和Javascript将Python代码的输出显示为Html，或者作为Javascript运行。</div><div class="line"></div><div class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Javascript</div><div class="line">Javascript(<span class="string">"alert('ok')"</span>)</div><div class="line"></div><div class="line">将在浏览器中运行Javascript代码。</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># Magic命令</span></div><div class="line"></div><div class="line">IPython中Magic命令有两种执行方式，以%开始的命令被称为行命令，它只对单行有效，以%%开头的为单元命令，它放在单元的第一行，对整个单元有效。例如timeit命令可以快速测试代码的执行效率，它可以作为行命令或者单元命令。</div><div class="line"></div><div class="line">%timeit <span class="number">1</span> + <span class="number">1</span></div><div class="line">%timeit <span class="number">1.0</span> + <span class="number">1.0</span></div><div class="line">%timeit <span class="string">"1"</span> + <span class="string">"1"</span></div><div class="line"></div><div class="line"><span class="number">10000000</span> loops, best <span class="keyword">of</span> <span class="number">3</span>: <span class="number">52</span> ns per <span class="keyword">loop</span></div><div class="line"><span class="number">10000000</span> loops, best <span class="keyword">of</span> <span class="number">3</span>: <span class="number">53.4</span> ns per <span class="keyword">loop</span></div><div class="line"><span class="number">10000000</span> loops, best <span class="keyword">of</span> <span class="number">3</span>: <span class="number">50.9</span> ns per <span class="keyword">loop</span></div><div class="line"></div><div class="line">%%timeit</div><div class="line">s = <span class="number">0</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">100</span>):</div><div class="line">    s += i</div><div class="line"></div><div class="line"><span class="number">100000</span> loops, best <span class="keyword">of</span> <span class="number">3</span>: <span class="number">11</span> us per <span class="keyword">loop</span></div><div class="line"></div><div class="line">每个Magic命令都可以指定参数，可以输入timeit?查看其帮助文档。下面让我们看看一些常用的Magic命令。</div><div class="line"></div><div class="line">%pylab命令将载入numpy和pylab，并且将这两个模块中的名字载入到全局名字空间中。缺省参数时，它使用matplotlib的缺省界面库显示图表，如果带inline参数则将图表作为图像插入到Notebook中。使用界面库显示图像时可以使用交互工具，而将图表直接插入到Notebook中则有利于编写文档。</div><div class="line"></div><div class="line">下面的例子，plot和random是从pylab和numpy中载入的。</div><div class="line"></div><div class="line">%pylab inline</div><div class="line">plot(random.randn(<span class="number">100</span>));</div><div class="line"></div><div class="line">Welcome <span class="keyword">to</span> pylab, a matplotlib-based Python environment [backend: module:<span class="regexp">//IPython.zmq.pylab.backend_inline].</span></div><div class="line">For more information, type 'help(pylab)'.</div><div class="line"></div><div class="line">pylab_img.png</div><div class="line"></div><div class="line">%load可以从文件或者网址载入代码到一个新的单元中，例如下面载入某个matplotlib的示例程序，并执行：</div><div class="line"></div><div class="line">%load http://matplotlib.org/mpl_examples/pylab_examples/histogram_demo.py</div></pre></td></tr></table></figure></p>
<p>#!/usr/bin/env python<br>import numpy as np<br>import matplotlib.mlab as mlab<br>import matplotlib.pyplot as plt</p>
<p>mu, sigma = 100, 15<br>x = mu + sigma*np.random.randn(10000)</p>
<h1 id="the-histogram-of-the-data"><a href="#the-histogram-of-the-data" class="headerlink" title="the histogram of the data"></a>the histogram of the data</h1><p>n, bins, patches = plt.hist(x, 50, normed=1, facecolor=’green’, alpha=0.75)</p>
<h1 id="add-a-‘best-fit’-line"><a href="#add-a-‘best-fit’-line" class="headerlink" title="add a ‘best fit’ line"></a>add a ‘best fit’ line</h1><p>y = mlab.normpdf( bins, mu, sigma)<br>l = plt.plot(bins, y, ‘r–’, linewidth=1)</p>
<p>plt.xlabel(‘Smarts’)<br>plt.ylabel(‘Probability’)<br>plt.title(r’$\mathrm{Histogram\ of\ IQ:}\ \mu=100,\ \sigma=15$’)<br>plt.axis([40, 160, 0, 0.03])<br>plt.grid(True)</p>
<p>plt.show()</p>
<p>hist_img.png<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div></pre></td><td class="code"><pre><div class="line">%prun用于代码的执行性能分析，可以作为行命令和单元命令使用。下面的程序分析numpy.linalg.det()的性能：</div><div class="line"></div><div class="line">%%prun</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">100</span>):</div><div class="line">    linalg.det(random.rand(<span class="number">10</span>,<span class="number">10</span>))</div><div class="line"></div><div class="line">其输出如下：</div><div class="line"></div><div class="line"><span class="number">3402</span> function calls <span class="keyword">in</span> <span class="number">0.096</span> seconds</div><div class="line"></div><div class="line">Ordered <span class="keyword">by</span>: internal <span class="built_in">time</span></div><div class="line"></div><div class="line">ncalls  tottime  percall  cumtime  percall filename:lineno(function)</div><div class="line">   <span class="number">100</span>    <span class="number">0.032</span>    <span class="number">0.000</span>    <span class="number">0.091</span>    <span class="number">0.001</span> linalg.py:<span class="number">1560</span>(slogdet)</div><div class="line">   <span class="number">300</span>    <span class="number">0.022</span>    <span class="number">0.000</span>    <span class="number">0.022</span>    <span class="number">0.000</span> &#123;method 'reduce' <span class="keyword">of</span> 'numpy.ufunc' objects&#125;</div><div class="line">   <span class="number">200</span>    <span class="number">0.011</span>    <span class="number">0.000</span>    <span class="number">0.012</span>    <span class="number">0.000</span> numeric.py:<span class="number">167</span>(asarray)</div><div class="line">   <span class="number">100</span>    <span class="number">0.006</span>    <span class="number">0.000</span>    <span class="number">0.006</span>    <span class="number">0.000</span> linalg.py:<span class="number">84</span>(_realType)</div><div class="line">   <span class="number">100</span>    <span class="number">0.005</span>    <span class="number">0.000</span>    <span class="number">0.005</span>    <span class="number">0.000</span> linalg.py:<span class="number">151</span>(_assertRank2)</div><div class="line">   ...</div><div class="line"></div><div class="line">%load_ext载入IPython的扩展模块，通过它可以载入更多的Magic命令。下面我们载入cythonmagic模块，并使用%%cython命令编译一个高效的频率统计函数<span class="built_in">count</span>()。</div><div class="line"></div><div class="line">%load_ext cythonmagic</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 测试Cython代码</span></div><div class="line"></div><div class="line">Cython的代码基本和Python的代码类似，但是可以使用类型声明，Cython可以使用这些类型声明产生更高效的C语言代码，并编译成Python的扩展模块。使用%%cython命令简化了编译扩展模块的过程，它会自动创建C语言程序，编译并载入。由于扩展模块无法卸载，因此IPython采用的策略是每次编译不同的代码都会产生一个全新的扩展模块。方便我们不退出Python环境即可运行新的代码。</div><div class="line"></div><div class="line">%%cython</div><div class="line">def <span class="built_in">count</span>(<span class="built_in">list</span> data):</div><div class="line">    cdef:</div><div class="line">        dict <span class="literal">result</span> = &#123;&#125;</div><div class="line">        int i, <span class="built_in">length</span> = len(data)</div><div class="line">        object <span class="built_in">item</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">length</span>):</div><div class="line">        <span class="built_in">item</span> = data[i]</div><div class="line">        <span class="keyword">if</span> <span class="built_in">item</span> <span class="keyword">in</span> <span class="literal">result</span>:</div><div class="line">            (&lt;<span class="built_in">list</span>&gt; <span class="literal">result</span>[<span class="built_in">item</span>]).append(i)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="literal">result</span>[<span class="built_in">item</span>] = [i]</div><div class="line"><span class="built_in">    return</span> <span class="literal">result</span></div><div class="line"></div><div class="line">下面是<span class="built_in">count</span>()的Python版本。</div><div class="line"></div><div class="line"><span class="keyword">from</span> collections import defaultdict</div><div class="line">def countpy(data):</div><div class="line">    <span class="literal">result</span> = defaultdict(<span class="built_in">list</span>)</div><div class="line">    <span class="keyword">for</span> i,<span class="built_in">item</span> <span class="keyword">in</span> enumerate(data):</div><div class="line">        <span class="literal">result</span>[<span class="built_in">item</span>].append(i)</div><div class="line"><span class="built_in">    return</span> <span class="literal">result</span></div><div class="line"></div><div class="line">先测试二者的结果是否相同：</div><div class="line"></div><div class="line">import random</div><div class="line">data = [random.randint(<span class="number">0</span>,<span class="number">100</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(<span class="number">10000</span>)]</div><div class="line"><span class="built_in">count</span>(data) == countpy(data)</div><div class="line"></div><div class="line">True</div><div class="line"></div><div class="line">然后测试它们的执行速度，可以看出Cython版本比Python的要快<span class="number">2</span>倍多。在这个测试中，Cython程序也同样使用列表和字典等对象，但是由于可以直接调用Python的C API，因此Cython版本的效率能提高几倍。如果只是单纯的数值运算，Cython能将程序提升到与C语言相近的速度。</div><div class="line"></div><div class="line">%timeit countpy(data)</div><div class="line">%timeit <span class="built_in">count</span>(data)</div><div class="line"></div><div class="line"><span class="number">100</span> loops, best <span class="keyword">of</span> <span class="number">3</span>: <span class="number">4.52</span> ms per loop</div><div class="line"><span class="number">1000</span> loops, best <span class="keyword">of</span> <span class="number">3</span>: <span class="number">1.8</span> ms per loop</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">The Zen <span class="keyword">of</span> Python, <span class="keyword">by</span> Tim Peters</div><div class="line">=================</div><div class="line">Beautiful <span class="keyword">is</span> better than ugly.</div><div class="line">Explicit <span class="keyword">is</span> better than implicit.</div><div class="line">Simple <span class="keyword">is</span> better than complex.</div><div class="line">Complex <span class="keyword">is</span> better than complicated.</div><div class="line">Flat <span class="keyword">is</span> better than nested.</div><div class="line">Sparse <span class="keyword">is</span> better than dense.</div><div class="line">Readability counts.</div><div class="line">Special cases aren't special enough <span class="keyword">to</span> break <span class="keyword">the</span> rules.</div><div class="line">Although practicality beats purity.</div><div class="line">Errors should never pass silently.</div><div class="line">Unless explicitly silenced.</div><div class="line">In <span class="keyword">the</span> face <span class="keyword">of</span> ambiguity, refuse <span class="keyword">the</span> temptation <span class="keyword">to</span> guess.</div><div class="line">There should be one<span class="comment">-- and preferably only one --obvious way to do it.</span></div><div class="line">Although <span class="keyword">that</span> way may <span class="keyword">not</span> be obvious <span class="keyword">at</span> <span class="keyword">first</span> unless you're Dutch.</div><div class="line">Now <span class="keyword">is</span> better than never.</div><div class="line">Although never <span class="keyword">is</span> often better than *right* now.</div><div class="line">If <span class="keyword">the</span> implementation <span class="keyword">is</span> hard <span class="keyword">to</span> explain, <span class="keyword">it</span>'s a bad idea.</div><div class="line">If <span class="keyword">the</span> implementation <span class="keyword">is</span> easy <span class="keyword">to</span> explain, <span class="keyword">it</span> may be a good idea.</div><div class="line">Namespaces are one honking great idea <span class="comment">-- let's do more of those!</span></div><div class="line"></div><div class="line"></div><div class="line">从网上搜寻了一下，这被称为python之禅，以下是翻译</div><div class="line"></div><div class="line"></div><div class="line">Python之禅</div><div class="line">赖勇浩翻译</div><div class="line"></div><div class="line">优美胜于丑陋（Python 以编写优美的代码为目标）</div><div class="line">明了胜于晦涩（优美的代码应当是明了的，命名规范，风格相似）</div><div class="line">简洁胜于复杂（优美的代码应当是简洁的，不要有复杂的内部实现）</div><div class="line">复杂胜于凌乱（如果复杂不可避免，那代码间也不能有难懂的关系，要保持接口简洁）</div><div class="line">扁平胜于嵌套（优美的代码应当是扁平的，不能有太多的嵌套）</div><div class="line">间隔胜于紧凑（优美的代码有适当的间隔，不要奢望一行代码解决问题）</div><div class="line">可读性很重要（优美的代码是可读的）</div><div class="line">即便假借特例的实用性之名，也不可违背这些规则（这些规则至高无上）</div><div class="line">不要包容所有错误，除非你确定需要这样做（精准地捕获异常，不写 except:pass 风格的代码）</div><div class="line">当存在多种可能，不要尝试去猜测</div><div class="line">而是尽量找一种，最好是唯一一种明显的解决方案（如果不确定，就用穷举法）</div><div class="line">虽然这并不容易，因为你不是 Python 之父（这里的 Dutch 是指 Guido ）</div><div class="line">做也许好过不做，但不假思索就动手还不如不做（动手之前要细思量）</div><div class="line">如果你无法向人描述你的方案，那肯定不是一个好方案；反之亦然（方案测评标准）</div><div class="line">命名空间是一种绝妙的理念，我们应当多加利用（倡导与号召）</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">python c interface </div><div class="line">=============</div><div class="line">Python C api中的绝大多数函数其参数和返回值中包含 PyObject*。这指针类型指向一个可以表示任何Python对象的不透明的数据结构。所有的Python对象在多数情况下以相同的方式对待。</div><div class="line"></div><div class="line">所有的Python对象(甚至是Python的整数)都包含一个类型和引用计数。一个对象的类型决定了其是一个整数、列表、用户自定义函数还是其他。</div><div class="line"></div><div class="line">引用计数对Python非常重要，引用计数必须显式地操作(通过Py_INCREF()、 Py_DECREF()等)。</div><div class="line"></div><div class="line">Python 的参数实际上是元组，因此传参实际上就是构造一个合适的元组。</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">ks 的做法是</div><div class="line">c中创建对象, 返回对象的地址, 可以用long表示</div><div class="line">python 中得到的long其实就是对象的地址, </div><div class="line">再将地址传回c中, 让c调用真实的对象</div><div class="line">只要确保对象没有被销毁</div><div class="line"></div><div class="line">`PyObject * args`</div><div class="line">`KingstarAPI::CKSOTPMdApi * user = (KingstarAPI::CKSOTPMdApi *) PyInt_AsLong(PyTuple_GET_ITEM(args, <span class="number">0</span>));`</div></pre></td></tr></table></figure></p>
<p>typedef struct _object {<br>    PyObject_HEAD<br>} PyObject;</p>
<p>typedef struct {<br>    PyObject_VAR_HEAD<br>    PyObject *ob_item[1];</p>
<pre><code>/* ob_item contains space for &apos;ob_size&apos; elements.
 * Items must normally not be NULL, except during construction when
 * the tuple is not yet visible outside the function that builds it.
 */
</code></pre><p>} PyTupleObject;</p>
<p>PyAPI_FUNC(long) PyInt_AsLong(PyObject *);</p>
<p>define PyAPI_FUNC(RTYPE) __declspec(dllimport) RTYPE</p>
<p>```</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/07/29/python包装c/" data-id="cirou3vtv000ma8m3acky99ze" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">c++</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-KSOTPMdApi" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/28/KSOTPMdApi/" class="article-date">
  <time datetime="2016-07-28T01:54:24.000Z" itemprop="datePublished">2016-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/28/KSOTPMdApi/">金仕达api</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="行情接口"><a href="#行情接口" class="headerlink" title="行情接口"></a>行情接口</h1><h1 id="初始化流程"><a href="#初始化流程" class="headerlink" title="初始化流程"></a>初始化流程</h1><ol>
<li>CKSOTPMdApi *pUserApi = CKSOTPMdApi::CreateOTPMdApi(“log”);</li>
<li>pUserApi-&gt;RegisterSpi(pSpi);</li>
<li>pUserApi-&gt;RegisterFront(config.option_lt_ip);</li>
<li>pUserApi-&gt;Init();<ul>
<li>m_pUserApi-&gt;ReqUserLogin (&amp;reqUserLogin, m_nRequestID++);</li>
<li>m_pUserApi-&gt;SubscribeMarketData(ppInstrumentID, iInstrumentID);</li>
<li>m_pUserApi-&gt;UnSubscribeMarketData(ppInstrumentID,iInstrumentID);</li>
<li>m_pUserApi-&gt;ReqUserLogout(&amp;UserLogout,3);</li>
</ul>
</li>
<li>pUserApi-&gt;Release();</li>
</ol>
<h1 id="定义的接口"><a href="#定义的接口" class="headerlink" title="定义的接口"></a>定义的接口</h1><ol>
<li>///获取当前交易日<br> virtual const char *GetTradingDay() = 0; </li>
<li>///订阅行情。<br> virtual int SubscribeMarketData(CKSOTPSpecificInstrumentField *ppInstrumentID[], int nCount) = 0;</li>
<li>///退订行情。<br> virtual int UnSubscribeMarketData(CKSOTPSpecificInstrumentField *ppInstrumentID[], int nCount) = 0;</li>
<li>///订阅询价。<br> virtual int SubscribeForQuoteRsp(char *ppInstrumentID[], int nCount) = 0;</li>
<li>///退订询价。<br> virtual int UnSubscribeForQuoteRsp(char *ppInstrumentID[], int nCount) = 0;</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/07/28/KSOTPMdApi/" data-id="cirou3vtd0008a8m3roe4uzv1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">c++</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/金仕达/">金仕达</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="drafts-chrome打不开" class="article article-type-drafts" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/25/chrome打不开/" class="article-date">
  <time datetime="2016-07-25T01:04:26.000Z" itemprop="datePublished">2016-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/25/chrome打不开/">chrome打不开</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="chrome打不开chrome-没响应"><a href="#chrome打不开chrome-没响应" class="headerlink" title="chrome打不开chrome 没响应"></a>chrome打不开chrome 没响应</h1><ul>
<li>加入 -no-sandbox 参数 后可以打开了, 提示这种模式不稳定</li>
</ul>
<h1 id="下载离线安装包"><a href="#下载离线安装包" class="headerlink" title="下载离线安装包"></a>下载离线安装包</h1><ul>
<li>我们在该网页链接的后面加上?standalone=1就可以下载到离线安装包，这是最新稳定版的离线安装包</li>
</ul>
<h1 id="java-使用json"><a href="#java-使用json" class="headerlink" title="java 使用json "></a>java 使用json </h1><h1 id="pip-默认utf8"><a href="#pip-默认utf8" class="headerlink" title="pip 默认utf8"></a>pip 默认utf8</h1><p>原因是windows的cmd环境默认为gbk编码，pip默认用utf8编码。<br>在Linux和Mac中，terminal环境默认的是utf8编码，所以不会报错。</p>
<p>python目录 Python27\Lib\site-packages 建一个文件sitecustomize.py<br>内容为：<br>import sys<br>sys.setdefaultencoding(‘gbk’) </p>
<ul>
<li>pip bundle my.pybundle -r requirement</li>
<li>pip install my.pybundle</li>
<li>pip –cache-dir</li>
<li>pip freeze &gt; requirements.txt</li>
<li>pip install -r requirements.txt</li>
<li>–download-cache=DIR可以指定下载安装文件时缓存至DIR路径</li>
</ul>
<h1 id="java-反射"><a href="#java-反射" class="headerlink" title="java 反射"></a>java 反射</h1><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Class</span>&lt;?&gt; task_class = <span class="keyword">Class</span>.forName(cls);</div><div class="line"><span class="function"><span class="keyword">Method</span> <span class="title">function</span> = <span class="title">task_class</span>.<span class="title">getMethod</span><span class="params">(met)</span>;</span></div><div class="line"><span class="function"><span class="keyword">function</span>.<span class="title">invoke</span><span class="params">(null)</span>;</span></div></pre></td></tr></table></figure>
<h1 id="c"><a href="#c" class="headerlink" title="c++"></a>c++</h1><p>通过.h和.lib文件，进行隐式的调用DLL文件</p>
<p>工具-&gt;选项-&gt;项目和解决方案-&gt;VC++目录-&gt;可执行文件<br>这里添加dll所在目录就可以了<br>设置环境变量当然也可以，但是环境变量设多了貌似不太好。 </p>
<p> VS 如何查看反汇编代码？</p>
<ol>
<li><p>打开反汇编窗口：调试模式下，按Ctrl+F11。</p>
</li>
<li><p>术语：</p>
</li>
</ol>
<p>　　2.1 ESP(Extended Stack Pointer): 堆栈指针，寄存器存放当前线程的栈顶指针；　　i.e: move ebp, esp – 用ebp保存当前栈指针；</p>
<p>　　2.2 EBP(Extended Base Pointer): 基址指针，寄存器存放当前线程的栈底指针；　　i.e: push ebp – 将基址指针压入栈；</p>
<p>　　2.3 EIP：寄存器存放下一个CPU指令存放的内存地址，当CPU执行完成当前的指令后，从EIP寄存器中读取下一条指令的内存地址，然后继续执行；</p>
<p>　　2.4 EAX: 累加器(Accumulator)，加法乘法指令的缺省寄存器；</p>
<p>　　2.5 EBX: 基地址(Base)寄存器，在内存寻址时存放基地址；</p>
<p>　　2.6 ECX：计数器(Counter)，是重复(REP)前缀指令和LOOP指令的内定计数器；</p>
<p>　　2.7 EDX：存放整数除法产生的余数；</p>
<p>　　2.8 ESI/EDI: 源/目标索引寄存器(Source/Destination Index)， 在很多字符串操作指令中，DS：ESI指向源串，而ES：EDI指向目标串。</p>
<blockquote>
<p>#pragma comment(lib, “../../sdk/win32/ksotpmarketdataapi.lib”)</p>
</blockquote>
<p>这是告诉编译器在编译形成的.obj文件和.exe文件中加一条信息，使得 链接器在链接库的时候要去找 ksotpmarketdataapi.lib这个库，不要先去找别的库。</p>
<p>(.exe文件找DLL 也是这种写法，例如 wsock32.dll).</p>
<blockquote>
<p>#pragma message(“Automatically linking with ksotpmarketdataapi.lib”)</p>
</blockquote>
<p>pragma message是用来告诉程序员，程序在编译时期的信息。而outputdebugstr则是告诉程序员，程序在运行时期的信息。</p>
<h1 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h1><p>Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件。 它支持多种类型的数据结构，如 字符串（strings）， 散列（hashes）， 列表（lists）， 集合（sets）， 有序集合（sorted sets） 与范围查询， bitmaps， hyperloglogs 和 地理空间（geospatial） 索引半径查询。 Redis 内置了 复制（replication），LUA脚本（Lua scripting）， LRU驱动事件（LRU eviction），事务（transactions） 和不同级别的 磁盘持久化（persistence）， 并通过 Redis哨兵（Sentinel）和自动 分区（Cluster）提供高可用性（high availability）。 </p>
<p>select 1<br>keys *<br>type 510050 </p>
<p>set 510050 “abcdefg”</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/07/25/chrome打不开/" data-id="cirou3vtj000aa8m3ki3ihayd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/chrome/">chrome</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/json/">json</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用virtualenv遇到bug" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/24/使用virtualenv遇到bug/" class="article-date">
  <time datetime="2016-07-24T05:24:43.000Z" itemprop="datePublished">2016-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/24/使用virtualenv遇到bug/">使用virtualenv遇到bug</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="执行-virtualenv-遇到错误"><a href="#执行-virtualenv-遇到错误" class="headerlink" title="执行 virtualenv 遇到错误"></a>执行 virtualenv 遇到错误</h1><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">File</span> <span class="string">"d:\python27\Lib\mimetypes.py"</span>, <span class="keyword">line</span> 249, <span class="keyword">in</span> enum_types</div><div class="line">    ctype = ctype.<span class="keyword">encode</span>(default_encoding) # omit <span class="keyword">in</span> 3.x!</div><div class="line">UnicodeDecodeError: 'ascii' codec can't <span class="keyword">decode</span> byte 0xbd <span class="keyword">in</span> position 11: ordinal                                                             </div><div class="line">not <span class="keyword">in</span> <span class="keyword">range</span>(128)</div></pre></td></tr></table></figure>
<blockquote>
<p>Python2.7在Windows上有一个bug，运行报错：<br>UnicodeDecodeError: ‘ascii’ codec can’t decode byte 0xc4 in position 33: ordinal not in range(128)<br>来自 : <a href="http://www.hankcs.com/program/python/solve-python-unicodedecodeerror.html" target="_blank" rel="external">http://www.hankcs.com/program/python/solve-python-unicodedecodeerror.html</a></p>
</blockquote>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决 : "></a>解决 : </h2><p>编辑Python27\Lib\mimetypes.py文件<br>242 行 enum_types 函数改为如下:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">enum_types</span><span class="params">(mimedb)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> count():</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            <span class="keyword">yield</span> _winreg.EnumKey(mimedb, i)</div><div class="line">        <span class="keyword">except</span> EnvironmentError:</div><div class="line">            <span class="keyword">break</span></div></pre></td></tr></table></figure></p>
<h1 id="python调用C-C"><a href="#python调用C-C" class="headerlink" title="python调用C/C++"></a>python调用C/C++</h1><h2 id="方法1：调用C-C-动态链接库（基础）"><a href="#方法1：调用C-C-动态链接库（基础）" class="headerlink" title="方法1：调用C/C++动态链接库（基础）"></a>方法1：调用C/C++动态链接库（基础）</h2><p>将C/C++的程序不经任何加工直接编译成动态链接库so或者dll，再使用python的ctypes调用即可</p>
<h2 id="方法2：调用C-C-编写的python扩展模块（基础）"><a href="#方法2：调用C-C-编写的python扩展模块（基础）" class="headerlink" title="方法2：调用C/C++编写的python扩展模块（基础）"></a>方法2：调用C/C++编写的python扩展模块（基础）</h2><p>这种方法比较好，用C/C++编写python的扩展模块，在python程序里面import进去就可以调用接口</p>
<p>编译成pyd文件</p>
<h2 id="方法3：调用二进制可执行文件（基础）"><a href="#方法3：调用二进制可执行文件（基础）" class="headerlink" title="方法3：调用二进制可执行文件（基础）"></a>方法3：调用二进制可执行文件（基础）</h2><p>os.system(cpptest)</p>
<h2 id="方法4：使用-SWIG（高级）"><a href="#方法4：使用-SWIG（高级）" class="headerlink" title="方法4：使用 SWIG（高级）"></a>方法4：使用 SWIG（高级）</h2><p>这是一个第三方的针对python的扩展包，需要些配置文件</p>
<h1 id="金仕达接口"><a href="#金仕达接口" class="headerlink" title="金仕达接口 "></a>金仕达接口 </h1><ul>
<li>ip和端口是什么</li>
<li>授权文件是什么</li>
<li>broker_id 是什么</li>
<li>是否有关联 </li>
</ul>
<h1 id="控制台什么都没有打印"><a href="#控制台什么都没有打印" class="headerlink" title="控制台什么都没有打印"></a>控制台什么都没有打印</h1><p>无法确认是否连接成功</p>
<p>(等待3秒不够，开始连接时都退出了)</p>
<h1 id="c-接口封装成python"><a href="#c-接口封装成python" class="headerlink" title="c++ 接口封装成python "></a>c++ 接口封装成python </h1><p>只有期货 没有期权？那个版本是老版本的api 提供了c++接口封装为python的解决方案  你可以看下新版本的api接口 如果需要新版本接口就按python发布包中的解决方案封装下 就可以用了</p>
<ul>
<li>好好弄python 包装各种其他语言</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/07/24/使用virtualenv遇到bug/" data-id="cirou3vu2000pa8m3nnco9jzy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bug/">bug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-node的使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/21/node的使用/" class="article-date">
  <time datetime="2016-07-21T12:54:24.000Z" itemprop="datePublished">2016-07-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/21/node的使用/">node的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="node-全局变量"><a href="#node-全局变量" class="headerlink" title="node 全局变量"></a>node 全局变量</h1><p>在浏览器 JavaScript 中，通常 window 是全局对象， 而 Node.js 中的全局对象是 global，所有全局变量（除了 global 本身以外）都是 global 对象的属性。</p>
<p>在 Node.js 我们可以直接访问到 global 的属性，而不需要在应用中包含它。</p>
<p>global 最根本的作用是作为全局变量的宿主。按照 ECMAScript 的定义，满足以下条 件的变量是全局变量： </p>
<ul>
<li>最外层定义的变量；</li>
<li>全局对象的属性；</li>
<li>隐式定义的变量（未定义直接赋值的变量）。</li>
</ul>
<p>当你定义一个全局变量时，这个变量同时也会成为全局对象的属性，反之亦然。需要注 意的是，在 Node.js 中你不可能在最外层定义变量，因为所有用户代码都是属于当前模块的， 而模块本身不是最外层上下文。</p>
<p>注意： 永远使用 var 定义变量以避免引入全局变量，因为全局变量会污染 命名空间，提高代码的耦合风险。</p>
<h2 id="filename"><a href="#filename" class="headerlink" title="__filename"></a>__filename</h2><h2 id="dirname"><a href="#dirname" class="headerlink" title="__dirname"></a>__dirname</h2><h2 id="setTimeout-cb-ms"><a href="#setTimeout-cb-ms" class="headerlink" title="setTimeout(cb, ms)"></a>setTimeout(cb, ms)</h2><h2 id="clearTimeout-t"><a href="#clearTimeout-t" class="headerlink" title="clearTimeout(t)"></a>clearTimeout(t)</h2><h2 id="setInterval-cb-ms"><a href="#setInterval-cb-ms" class="headerlink" title="setInterval(cb, ms)"></a>setInterval(cb, ms)</h2><h2 id="console"><a href="#console" class="headerlink" title="console"></a>console</h2><h2 id="process"><a href="#process" class="headerlink" title="process"></a>process</h2><p>它用于描述当前Node.js 进程状态的对象，提供了一个与操作系统的简单接口。通常在你写本地命令行程序的时候，少不了要 和它打交道</p>
<p><strong>__filename</strong> 表示当前正在执行的脚本的文件名。它将输出文件所在位置的绝对路径，且和命令行参数所指定的文件名不一定相同。 如果在模块中，返回的值是模块文件的路径。 </p>
<blockquote>
<p>  // 输出全局变量 <strong>filename 的值<br>    console.log( </strong>filename );<br>    // 输出全局变量 <strong>dirname 的值<br>    console.log( </strong>dirname );<br>    setTimeout(cb, ms)<br>    clearTimeout(t)<br>    setInterval(cb, ms)<br>    console<br>    process 提供了很多方法<br>        process.on(‘exit’, function(code) {<br>        // 以下代码永远不会执行<br>        setTimeout(function() {<br>            console.log(“该代码不会执行”);<br>        }, 0);<br>        console.log(‘退出码为:’, code);<br>        });<br>        console.log(“程序执行结束”);  </p>
</blockquote>
<h1 id="怎么用-require"><a href="#怎么用-require" class="headerlink" title="怎么用 require"></a>怎么用 require</h1><p><img src="./image/nodejs-require.jpg" alt="alt"></p>
<p><strong>exports</strong> 对象会为外部所用</p>
<p>module.exports才是真正的接口，exports只不过是它的一个辅助工具</p>
<h1 id="node-事件机制"><a href="#node-事件机制" class="headerlink" title="node 事件机制 "></a>node 事件机制 </h1><p>Node.js 所有的异步 I/O 操作在完成时都会发送一个事件到事件队列。</p>
<h2 id="EventEmitter-类"><a href="#EventEmitter-类" class="headerlink" title="EventEmitter 类"></a>EventEmitter 类</h2><ul>
<li>events 模块只提供了一个对象： <code>events.EventEmitter</code>。<br>  EventEmitter 的核心就是事件触发与事件监听器功能的封装。<br>  你可以通过 <code>require(&quot;events&quot;);</code> 来访问该模块。  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//event.js 文件</span></div><div class="line"><span class="keyword">var</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>).EventEmitter; </div><div class="line"><span class="keyword">var</span> event = <span class="keyword">new</span> EventEmitter(); </div><div class="line">event.on(<span class="string">'some_event'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'some_event 事件触发'</span>); </div><div class="line">&#125;); </div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </div><div class="line">    event.emit(<span class="string">'some_event'</span>); </div><div class="line">&#125;, <span class="number">1000</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="node-处理二进制"><a href="#node-处理二进制" class="headerlink" title="node 处理二进制"></a>node 处理二进制</h1><p>JavaScript 语言自身只有字符串数据类型，没有二进制数据类型。</p>
<p>但在处理像TCP流或文件流时，必须使用到二进制数据。<br>因此在 Node.js中，定义了一个 Buffer 类，该类用来创建一个专门存放二进制数据的缓存区。</p>
<p>在 Node.js 中，Buffer 类是随 Node 内核一起发布的核心库。<br>Buffer 库为 Node.js 带来了一种存储原始数据的方法，可以让 Node.js 处理二进制数据，<br>每当需要在 Node.js 中处理I/O操作中移动的数据时，就有可能使用 Buffer 库。<br>原始数据存储在 Buffer 类的实例中。<br>一个 Buffer 类似于一个整数数组，但它对应于 V8 堆内存之外的一块原始内存。</p>
<blockquote>
<p>  var buf = new Buffer(10);<br>    var buf = new Buffer([10, 20, 30, 40, 50]);<br>    var buf = new Buffer(“www.runoob.com”, “utf-8”);<br>    utf-8 是默认的编码方式，此外它同样支持以下编码：”ascii”, “utf8”, “utf16le”, “ucs2”, “base64” 和 “hex”。<br>    写入<br>    buf.write(string[, offset[, length]][, encoding])<br>    读取<br>    buf.toString([encoding[, start[, end]]])<br>    buf.toJSON()<br>    Buffer.concat(list[, totalLength])<br>    buf.compare(otherBuffer);<br>    buf.copy(targetBuffer[, targetStart[, sourceStart[, sourceEnd]]])  </p>
</blockquote>
<h1 id="node-处理流"><a href="#node-处理流" class="headerlink" title="node 处理流"></a>node 处理流</h1><p>Stream 是一个抽象接口，Node 中有很多对象实现了这个接口。例如，对http 服务器发起请求的request 对象就是一个 Stream，还有stdout（标准输出）。 </p>
<p>Node.js，Stream 有四种流类型：</p>
<ul>
<li>Readable - 可读操作。</li>
<li>Writable - 可写操作。</li>
<li>Duplex - 可读可写操作.</li>
<li>Transform - 操作被写入数据，然后读出结果。</li>
</ul>
<p>所有的 Stream 对象都是 EventEmitter 的实例。常用的事件有：</p>
<ul>
<li>data - 当有数据可读时触发。</li>
<li>end - 没有更多的数据可读时触发。</li>
<li>error - 在接收和写入过程中发生错误时触发。</li>
<li>finish - 所有数据已被写入到底层系统时触发。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"><span class="keyword">var</span> data = <span class="string">''</span>;</div><div class="line"></div><div class="line"><span class="comment">// 创建可读流</span></div><div class="line"><span class="keyword">var</span> readerStream = fs.createReadStream(<span class="string">'input.txt'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 设置编码为 utf8。</span></div><div class="line">readerStream.setEncoding(<span class="string">'UTF8'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 处理流事件 --&gt; data, end, and error</span></div><div class="line">readerStream.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>) </span>&#123;</div><div class="line">   data += chunk;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">readerStream.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="built_in">console</span>.log(data);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">readerStream.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">   <span class="built_in">console</span>.log(err.stack);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"程序执行完毕"</span>);</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"><span class="keyword">var</span> data = <span class="string">'菜鸟教程官网地址：www.runoob.com'</span>;</div><div class="line"></div><div class="line"><span class="comment">// 创建一个可以写入的流，写入到文件 output.txt 中</span></div><div class="line"><span class="keyword">var</span> writerStream = fs.createWriteStream(<span class="string">'output.txt'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 使用 utf8 编码写入数据</span></div><div class="line">writerStream.write(data,<span class="string">'UTF8'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 标记文件末尾</span></div><div class="line">writerStream.end();</div><div class="line"></div><div class="line"><span class="comment">// 处理流事件 --&gt; data, end, and error</span></div><div class="line">writerStream.on(<span class="string">'finish'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"写入完成。"</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">writerStream.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">   <span class="built_in">console</span>.log(err.stack);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"程序执行完毕"</span>);</div></pre></td></tr></table></figure>
<h1 id="Node-js-常用工具"><a href="#Node-js-常用工具" class="headerlink" title="Node.js 常用工具"></a>Node.js 常用工具</h1><p>util 是一个Node.js 核心模块，提供常用函数的集合，用于弥补核心JavaScript 的功能 过于精简的不足。 </p>
<h1 id="util-inherits"><a href="#util-inherits" class="headerlink" title="util.inherits"></a>util.inherits</h1><p>util.inherits(constructor, superConstructor)是一个实现对象间原型继承 的函数。 </p>
<p>JavaScript 的面向对象特性是基于原型的，与常见的基于类的不同。JavaScript 没有 提供对象继承的语言级别特性，而是通过原型复制来实现的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>); </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Base</span>(<span class="params"></span>) </span>&#123; </div><div class="line">	<span class="keyword">this</span>.name = <span class="string">'base'</span>; </div><div class="line">	<span class="keyword">this</span>.base = <span class="number">1991</span>; </div><div class="line">	<span class="keyword">this</span>.sayHello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'Hello '</span> + <span class="keyword">this</span>.name); </div><div class="line">	&#125;; </div><div class="line">&#125; </div><div class="line">Base.prototype.showName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </div><div class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</div><div class="line">&#125;; </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sub</span>(<span class="params"></span>) </span>&#123; </div><div class="line">	<span class="keyword">this</span>.name = <span class="string">'sub'</span>; </div><div class="line">&#125; </div><div class="line">util.inherits(Sub, Base); </div><div class="line"><span class="keyword">var</span> objBase = <span class="keyword">new</span> Base(); </div><div class="line">objBase.showName(); </div><div class="line">objBase.sayHello(); </div><div class="line"><span class="built_in">console</span>.log(objBase); </div><div class="line"><span class="keyword">var</span> objSub = <span class="keyword">new</span> Sub(); </div><div class="line">objSub.showName(); </div><div class="line"><span class="comment">//objSub.sayHello(); </span></div><div class="line"><span class="built_in">console</span>.log(objSub);</div></pre></td></tr></table></figure>
<blockquote>
<p>注意：Sub 仅仅继承了Base 在原型中定义的函数，而构造函数内部创造的 base 属 性和 sayHello 函数都没有被 Sub 继承。<br>    同时，在原型中定义的属性不会被console.log 作 为对象的属性输出。</p>
</blockquote>
<h2 id="util-inspect"><a href="#util-inspect" class="headerlink" title="util.inspect"></a>util.inspect</h2><p>util.inspect(object,[showHidden],[depth],[colors])是一个将任意对象转换 为字符串的方法，通常用于调试和错误输出。它至少接受一个参数 object，即要转换的对象。 </p>
<p>showHidden 是一个可选参数，如果值为 true，将会输出更多隐藏信息。</p>
<p>depth 表示最大递归的层数，如果对象很复杂，你可以指定层数以控制输出信息的多 少。如果不指定depth，默认会递归2层，指定为 null 表示将不限递归层数完整遍历对象。 如果color 值为 true，输出格式将会以ANSI 颜色编码，通常用于在终端显示更漂亮 的效果。</p>
<p>特别要指出的是，util.inspect 并不会简单地直接把对象转换为字符串，即使该对 象定义了toString 方法也不会调用。</p>
<h2 id="util-isArray-object"><a href="#util-isArray-object" class="headerlink" title="util.isArray(object)"></a>util.isArray(object)</h2><h2 id="util-isRegExp-object"><a href="#util-isRegExp-object" class="headerlink" title="util.isRegExp(object)"></a>util.isRegExp(object)</h2><h2 id="util-isDate-object"><a href="#util-isDate-object" class="headerlink" title="util.isDate(object)"></a>util.isDate(object)</h2><h2 id="util-isError-object"><a href="#util-isError-object" class="headerlink" title="util.isError(object)"></a>util.isError(object)</h2><h1 id="node-文件系统"><a href="#node-文件系统" class="headerlink" title="node 文件系统"></a>node 文件系统</h1><p>Node.js 提供一组类似 UNIX（POSIX）标准的文件操作API。 Node 导入文件系统模块(fs)语法如下所示：</p>
<p><code>var fs = require(&quot;fs&quot;)</code></p>
<p>Node.js 文件系统（fs 模块）模块中的方法均有异步和同步版本，例如读取文件内容的函数有异步的 fs.readFile() 和同步的 fs.readFileSync()。</p>
<p>异步的方法函数最后一个参数为回调函数，回调函数的第一个参数包含了错误信息(error)。</p>
<p>建议大家是用异步方法，比起同步，异步方法性能更高，速度更快，而且没有阻塞。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = require(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 异步读取</span></div><div class="line">fs.readFile('<span class="keyword">input</span>.txt', function (<span class="keyword">err</span>, data) &#123;</div><div class="line">   <span class="keyword">if</span> (<span class="keyword">err</span>) &#123;</div><div class="line">       <span class="keyword">return</span> console.<span class="keyword">error</span>(<span class="keyword">err</span>);</div><div class="line">   &#125;</div><div class="line">   console.<span class="built_in">log</span>(<span class="string">"异步读取: "</span> + data.<span class="keyword">toString</span>());</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 同步读取</span></div><div class="line"><span class="keyword">var</span> data = fs.readFileSync('<span class="keyword">input</span>.txt');</div><div class="line">console.<span class="built_in">log</span>(<span class="string">"同步读取: "</span> + data.<span class="keyword">toString</span>());</div><div class="line"></div><div class="line">console.<span class="built_in">log</span>(<span class="string">"程序执行完毕。"</span>);</div></pre></td></tr></table></figure>
<ul>
<li><p>打开文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="comment">// 异步打开文件</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"准备打开文件！"</span>);</div><div class="line">fs.open(<span class="string">'input.txt'</span>, <span class="string">'r+'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, fd</span>) </span>&#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">   &#125;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"文件打开成功！"</span>);     </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>获取文件信息</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line">fs.stat(<span class="string">'/Users/liuht/code/itbilu/demo/fs.js'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, stats</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(stats.isFile()); 		<span class="comment">//true</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>写入文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"准备写入文件"</span>);</div><div class="line">fs.writeFile(<span class="string">'input.txt'</span>, <span class="string">'我是通过写入的文件内容！'</span>,  <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">   &#125;</div><div class="line">   <span class="built_in">console</span>.log(<span class="string">"数据写入成功！"</span>);</div><div class="line">   <span class="built_in">console</span>.log(<span class="string">"--------我是分割线-------------"</span>)</div><div class="line">   <span class="built_in">console</span>.log(<span class="string">"读取写入的数据！"</span>);</div><div class="line">   fs.readFile(<span class="string">'input.txt'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (err) &#123;</div><div class="line">         <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">      &#125;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">"异步读取文件数据: "</span> + data.toString());</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>读取文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"><span class="keyword">var</span> buf = <span class="keyword">new</span> Buffer(<span class="number">1024</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"准备打开已存在的文件！"</span>);</div><div class="line">fs.open(<span class="string">'input.txt'</span>, <span class="string">'r+'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, fd</span>) </span>&#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">   &#125;</div><div class="line">   <span class="built_in">console</span>.log(<span class="string">"文件打开成功！"</span>);</div><div class="line">   <span class="built_in">console</span>.log(<span class="string">"准备读取文件："</span>);</div><div class="line">   fs.read(fd, buf, <span class="number">0</span>, buf.length, <span class="number">0</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, bytes</span>)</span>&#123;</div><div class="line">      <span class="keyword">if</span> (err)&#123;</div><div class="line">         <span class="built_in">console</span>.log(err);</div><div class="line">      &#125;</div><div class="line">      <span class="built_in">console</span>.log(bytes + <span class="string">"  字节被读取"</span>);</div><div class="line">      </div><div class="line">      <span class="comment">// 仅输出读取的字节</span></div><div class="line">      <span class="keyword">if</span>(bytes &gt; <span class="number">0</span>)&#123;</div><div class="line">         <span class="built_in">console</span>.log(buf.slice(<span class="number">0</span>, bytes).toString());</div><div class="line">      &#125;</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>关闭文件</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = require(<span class="string">"fs"</span>);</div><div class="line"><span class="keyword">var</span> buf = new Buffer(1024);</div><div class="line"></div><div class="line">console.<span class="built_in">log</span>(<span class="string">"准备打开文件！"</span>);</div><div class="line">fs.<span class="keyword">open</span>('<span class="keyword">input</span>.txt', 'r+', function(<span class="keyword">err</span>, fd) &#123;</div><div class="line">   <span class="keyword">if</span> (<span class="keyword">err</span>) &#123;</div><div class="line">       <span class="keyword">return</span> console.<span class="keyword">error</span>(<span class="keyword">err</span>);</div><div class="line">   &#125;</div><div class="line">   console.<span class="built_in">log</span>(<span class="string">"文件打开成功！"</span>);</div><div class="line">   console.<span class="built_in">log</span>(<span class="string">"准备读取文件！"</span>);</div><div class="line">   fs.<span class="keyword">read</span>(fd, buf, 0, buf.length, 0, function(<span class="keyword">err</span>, bytes)&#123;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">err</span>)&#123;</div><div class="line">         console.<span class="built_in">log</span>(<span class="keyword">err</span>);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="comment">// 仅输出读取的字节</span></div><div class="line">      <span class="keyword">if</span>(bytes &gt; 0)&#123;</div><div class="line">         console.<span class="built_in">log</span>(buf.slice(0, bytes).<span class="keyword">toString</span>());</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="comment">// 关闭文件</span></div><div class="line">      fs.<span class="keyword">close</span>(fd, function(<span class="keyword">err</span>)&#123;</div><div class="line">         <span class="keyword">if</span> (<span class="keyword">err</span>)&#123;</div><div class="line">            console.<span class="built_in">log</span>(<span class="keyword">err</span>);</div><div class="line">         &#125; </div><div class="line">         console.<span class="built_in">log</span>(<span class="string">"文件关闭成功"</span>);</div><div class="line">      &#125;);</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>截取文件</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = require(<span class="string">"fs"</span>);</div><div class="line"><span class="keyword">var</span> buf = new Buffer(1024);</div><div class="line"></div><div class="line">console.<span class="built_in">log</span>(<span class="string">"准备打开文件！"</span>);</div><div class="line">fs.<span class="keyword">open</span>('<span class="keyword">input</span>.txt', 'r+', function(<span class="keyword">err</span>, fd) &#123;</div><div class="line">   <span class="keyword">if</span> (<span class="keyword">err</span>) &#123;</div><div class="line">       <span class="keyword">return</span> console.<span class="keyword">error</span>(<span class="keyword">err</span>);</div><div class="line">   &#125;</div><div class="line">   console.<span class="built_in">log</span>(<span class="string">"文件打开成功！"</span>);</div><div class="line">   console.<span class="built_in">log</span>(<span class="string">"截取10字节后的文件内容。"</span>);</div><div class="line">   </div><div class="line">   <span class="comment">// 截取文件</span></div><div class="line">   fs.ftruncate(fd, 10, function(<span class="keyword">err</span>)&#123;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">err</span>)&#123;</div><div class="line">         console.<span class="built_in">log</span>(<span class="keyword">err</span>);</div><div class="line">      &#125; </div><div class="line">      console.<span class="built_in">log</span>(<span class="string">"文件截取成功。"</span>);</div><div class="line">      console.<span class="built_in">log</span>(<span class="string">"读取相同的文件"</span>); </div><div class="line">      fs.<span class="keyword">read</span>(fd, buf, 0, buf.length, 0, function(<span class="keyword">err</span>, bytes)&#123;</div><div class="line">         <span class="keyword">if</span> (<span class="keyword">err</span>)&#123;</div><div class="line">            console.<span class="built_in">log</span>(<span class="keyword">err</span>);</div><div class="line">         &#125;</div><div class="line"></div><div class="line">         <span class="comment">// 仅输出读取的字节</span></div><div class="line">         <span class="keyword">if</span>(bytes &gt; 0)&#123;</div><div class="line">            console.<span class="built_in">log</span>(buf.slice(0, bytes).<span class="keyword">toString</span>());</div><div class="line">         &#125;</div><div class="line"></div><div class="line">         <span class="comment">// 关闭文件</span></div><div class="line">         fs.<span class="keyword">close</span>(fd, function(<span class="keyword">err</span>)&#123;</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">err</span>)&#123;</div><div class="line">               console.<span class="built_in">log</span>(<span class="keyword">err</span>);</div><div class="line">            &#125; </div><div class="line">            console.<span class="built_in">log</span>(<span class="string">"文件关闭成功！"</span>);</div><div class="line">         &#125;);</div><div class="line">      &#125;);</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>删除文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"准备删除文件！"</span>);</div><div class="line">fs.unlink(<span class="string">'input.txt'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">   &#125;</div><div class="line">   <span class="built_in">console</span>.log(<span class="string">"文件删除成功！"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>创建目录</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"创建目录 /tmp/test/"</span>);</div><div class="line">fs.mkdir(<span class="string">"/tmp/test/"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">   &#125;</div><div class="line">   <span class="built_in">console</span>.log(<span class="string">"目录创建成功。"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>读取目录</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"查看 /tmp 目录"</span>);</div><div class="line">fs.readdir(<span class="string">"/tmp/"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err, files</span>)</span>&#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</div><div class="line">   &#125;</div><div class="line">   files.forEach( <span class="function"><span class="keyword">function</span> (<span class="params">file</span>)</span>&#123;</div><div class="line">       <span class="built_in">console</span>.log( file );</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>删除目录</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = require(<span class="string">"fs"</span>);</div><div class="line"></div><div class="line">console.<span class="built_in">log</span>(<span class="string">"准备删除目录 /tmp/test"</span>);</div><div class="line">fs.<span class="keyword">rmdir</span>(<span class="string">"/tmp/test"</span>,function(<span class="keyword">err</span>)&#123;</div><div class="line">   <span class="keyword">if</span> (<span class="keyword">err</span>) &#123;</div><div class="line">       <span class="keyword">return</span> console.<span class="keyword">error</span>(<span class="keyword">err</span>);</div><div class="line">   &#125;</div><div class="line">   console.<span class="built_in">log</span>(<span class="string">"读取 /tmp 目录"</span>);</div><div class="line">   fs.readdir(<span class="string">"/tmp/"</span>,function(<span class="keyword">err</span>, files)&#123;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">err</span>) &#123;</div><div class="line">          <span class="keyword">return</span> console.<span class="keyword">error</span>(<span class="keyword">err</span>);</div><div class="line">      &#125;</div><div class="line">      files.<span class="keyword">forEach</span>( function (<span class="keyword">file</span>)&#123;</div><div class="line">          console.<span class="built_in">log</span>( <span class="keyword">file</span> );</div><div class="line">      &#125;);</div><div class="line">   &#125;);</div><div class="line">&#125;);</div><div class="line">```    </div><div class="line"></div><div class="line"></div><div class="line">node  获取 <span class="keyword">post</span> /get 请求</div><div class="line">================</div><div class="line">## 获取GET请求内容</div><div class="line"></div><div class="line">由于GET请求直接被嵌入在路径中，URL是完整的请求路径，包括了?后面的部分，因此你可以手动解析后面的内容作为GET请求的参数。 </div><div class="line"></div><div class="line">node.js中url模块中的<span class="keyword">parse</span>函数提供了这个功能。</div><div class="line"></div><div class="line"></div><div class="line">## 获取<span class="keyword">POST</span>请求内容</div><div class="line"></div><div class="line"><span class="keyword">POST</span>请求的内容全部的都在请求体中，http.ServerRequest并没有一个属性内容为请求体，原因是等待请求体传输可能是一件耗时的工作。</div><div class="line"></div><div class="line">比如上传文件，而很多时候我们可能并不需要理会请求体的内容，恶意的<span class="keyword">POST</span>请求会大大消耗服务器的资源，所有node.js默认是不会解析请求体的， 当你需要的时候，需要手动来做。</div></pre></td></tr></table></figure>
</li>
</ul>
<p>var http = require(‘http’);<br>var querystring = require(‘querystring’);<br>var util = require(‘util’);</p>
<p>http.createServer(function(req, res){<br>    var post = ‘’;     //定义了一个post变量，用于暂存请求体的信息</p>
<pre><code>req.on(&apos;data&apos;, function(chunk){    //通过req的data事件监听函数，每当接受到请求体的数据，就累加到post变量中
    post += chunk;
});

req.on(&apos;end&apos;, function(){    //在end事件触发后，通过querystring.parse将post解析为真正的POST请求格式，然后向客户端返回。
    post = querystring.parse(post);
    res.end(util.inspect(post));
});
</code></pre><p>}).listen(3000);</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="markdown"><span class="section">node  常用工具模块 </span></span></div><div class="line">==============</div><div class="line"><span class="section">## OS</span></div><div class="line"></div><div class="line"><span class="bullet">1. </span>os.tmpdir()</div><div class="line">返回操作系统的默认临时文件夹。 </div><div class="line"><span class="bullet">2. </span>os.endianness()</div><div class="line">返回 CPU 的字节序，可能的是 "BE" 或 "LE"。 </div><div class="line"><span class="bullet">3. </span>os.hostname()</div><div class="line">返回操作系统的主机名。 </div><div class="line"><span class="bullet">4. </span>os.type()</div><div class="line">返回操作系统名 </div><div class="line"><span class="bullet">5. </span>os.platform()</div><div class="line">返回操作系统名 </div><div class="line"><span class="bullet">6. </span>os.arch()</div><div class="line">返回操作系统 CPU 架构，可能的值有 "x64"、"arm" 和 "ia32"。 </div><div class="line"><span class="bullet">7. </span>os.release()</div><div class="line">返回操作系统的发行版本。 </div><div class="line"><span class="bullet">8. </span>os.uptime()</div><div class="line">返回操作系统运行的时间，以秒为单位。 </div><div class="line"><span class="bullet">9. </span>os.loadavg()</div><div class="line">返回一个包含 1、5、15 分钟平均负载的数组。 </div><div class="line"><span class="bullet">10. </span>os.totalmem()</div><div class="line">返回系统内存总量，单位为字节。 </div><div class="line"><span class="bullet">11. </span>os.freemem()</div><div class="line">返回操作系统空闲内存量，单位是字节。 </div><div class="line"><span class="bullet">12. </span>os.cpus()</div><div class="line">返回一个对象数组，包含所安装的每个 CPU/内核的信息：型号、速度（单位 MHz）、时间（一个包含 user、nice、sys、idle 和 irq 所使用 CPU/内核毫秒数的对象）。 </div><div class="line"><span class="bullet">13. </span>os.networkInterfaces()</div><div class="line">获得网络接口列表。 </div><div class="line"></div><div class="line"></div><div class="line"><span class="section">## Path</span></div><div class="line"><span class="bullet">1. </span>path.normalize(p)</div><div class="line">规范化路径，注意'..' 和 '.'。 </div><div class="line"><span class="bullet">2. </span>path.join([<span class="string">path1</span>][<span class="symbol">, path2</span>][<span class="string">, ...</span>])</div><div class="line">用于连接路径。该方法的主要用途在于，会正确使用当前系统的路径分隔符，Unix系统是"/"，Windows系统是"\"。 </div><div class="line"><span class="bullet">3. </span>path.resolve([from ...], to)</div><div class="line">将 to 参数解析为绝对路径。 </div><div class="line"><span class="bullet">4. </span>path.isAbsolute(path)</div><div class="line">判断参数 path 是否是绝对路径。 </div><div class="line"><span class="bullet">5. </span>path.relative(from, to)</div><div class="line">用于将相对路径转为绝对路径。 </div><div class="line"><span class="bullet">6. </span>path.dirname(p)</div><div class="line">返回路径中代表文件夹的部分，同 Unix 的dirname 命令类似。 </div><div class="line"><span class="bullet">7. </span>path.basename(p[, ext])</div><div class="line">返回路径中的最后一部分。同 Unix 命令 bashname 类似。 </div><div class="line"><span class="bullet">8. </span>path.extname(p)</div><div class="line">返回路径中文件的后缀名，即路径中最后一个'.'之后的部分。如果一个路径中并不包含'.'或该路径只包含一个'.' 且这个'.'为路径的第一个字符，则此命令返回空字符串。 </div><div class="line"><span class="bullet">9. </span>path.parse(pathString)</div><div class="line">返回路径字符串的对象。 </div><div class="line"><span class="bullet">10. </span>path.format(pathObject)</div><div class="line">从对象中返回路径字符串，和 path.parse 相反。 </div><div class="line"></div><div class="line"></div><div class="line"><span class="section">## Net</span></div><div class="line"><span class="bullet">1. </span>net.createServer([<span class="string">options</span>][<span class="symbol">, connectionListener</span>])</div><div class="line">创建一个 TCP 服务器。参数 connectionListener 自动给 'connection' 事件创建监听器。 </div><div class="line"><span class="bullet">2. </span>net.connect(options[, connectionListener])</div><div class="line">返回一个新的 'net.Socket'，并连接到指定的地址和端口。</div><div class="line"> 当 socket 建立的时候，将会触发 'connect' 事件。 </div><div class="line"><span class="bullet">3. </span>net.createConnection(options[, connectionListener])</div><div class="line">创建一个到端口 port 和 主机 host的 TCP 连接。 host 默认为 'localhost'。 </div><div class="line"><span class="bullet">4. </span>net.connect(port[<span class="string">, host</span>][<span class="symbol">, connectListener</span>])</div><div class="line">创建一个端口为 port 和主机为 host的 TCP 连接 。host 默认为 'localhost'。参数 connectListener 将会作为监听器添加到 'connect' 事件。返回 'net.Socket'。 </div><div class="line"><span class="bullet">5. </span>net.createConnection(port[<span class="string">, host</span>][<span class="symbol">, connectListener</span>])</div><div class="line">创建一个端口为 port 和主机为 host的 TCP 连接 。host 默认为 'localhost'。参数 connectListener 将会作为监听器添加到 'connect' 事件。返回 'net.Socket'。 </div><div class="line"><span class="bullet">6. </span>net.connect(path[, connectListener])</div><div class="line">创建连接到 path 的 unix socket 。参数 connectListener 将会作为监听器添加到 'connect' 事件上。返回 'net.Socket'。 </div><div class="line"><span class="bullet">7. </span>net.createConnection(path[, connectListener])</div><div class="line">创建连接到 path 的 unix socket 。参数 connectListener 将会作为监听器添加到 'connect' 事件。返回 'net.Socket'。 </div><div class="line"><span class="bullet">8. </span>net.isIP(input)</div><div class="line">检测输入的是否为 IP 地址。 IPV4 返回 4， IPV6 返回 6，其他情况返回 0。 </div><div class="line"><span class="bullet">9. </span>net.isIPv4(input)</div><div class="line">如果输入的地址为 IPV4， 返回 true，否则返回 false。 </div><div class="line"><span class="bullet">10. </span>net.isIPv6(input)</div><div class="line">如果输入的地址为 IPV6， 返回 true，否则返回 false。 </div><div class="line"></div><div class="line"><span class="code">    * net.Server</span></div><div class="line"><span class="code">        1. server.listen(port[, host][, backlog][, callback])</span></div><div class="line"><span class="code">        监听指定端口 port 和 主机 host ac连接。 默认情况下 host 接受任何 IPv4 地址(INADDR_ANY)的直接连接。端口 port 为 0 时，则会分配一个随机端口。 </span></div><div class="line"><span class="code">        2. server.listen(path[, callback])</span></div><div class="line"><span class="code">        通过指定 path 的连接，启动一个本地 socket 服务器。 </span></div><div class="line"><span class="code">        3. server.listen(handle[, callback])</span></div><div class="line"><span class="code">        通过指定句柄连接。 </span></div><div class="line"><span class="code">        4. server.listen(options[, callback])</span></div><div class="line"><span class="code">        options 的属性：端口 port, 主机 host, 和 backlog, 以及可选参数 callback 函数, 他们在一起调用server.listen(port, [host], [backlog], [callback])。还有，参数 path 可以用来指定 UNIX socket。 </span></div><div class="line"><span class="code">        5. server.close([callback])</span></div><div class="line"><span class="code">        服务器停止接收新的连接，保持现有连接。这是异步函数，当所有连接结束的时候服务器会关闭，并会触发 'close' 事件。 </span></div><div class="line"><span class="code">        6. server.address()</span></div><div class="line"><span class="code">        操作系统返回绑定的地址，协议族名和服务器端口。 </span></div><div class="line"><span class="code">        7. server.unref()</span></div><div class="line"><span class="code">        如果这是事件系统中唯一一个活动的服务器，调用 unref 将允许程序退出。 </span></div><div class="line"><span class="code">        8. server.ref()</span></div><div class="line"><span class="code">        与 unref 相反，如果这是唯一的服务器，在之前被 unref 了的服务器上调用 ref 将不会让程序退出（默认行为）。如果服务器已经被 ref，则再次调用 ref 并不会产生影响。 </span></div><div class="line"><span class="code">        9. server.getConnections(callback)</span></div><div class="line"><span class="code">        异步获取服务器当前活跃连接的数量。当 socket 发送给子进程后才有效；回调函数有 2 个参数 err 和 count。 </span></div><div class="line"></div><div class="line"><span class="code">    * net.Socket</span></div><div class="line"><span class="code">        1. lookup</span></div><div class="line"><span class="code">        在解析域名后，但在连接前，触发这个事件。对 UNIX sokcet 不适用。 </span></div><div class="line"><span class="code">        2. connect</span></div><div class="line"><span class="code">        成功建立 socket 连接时触发。 </span></div><div class="line"><span class="code">        3. data</span></div><div class="line"><span class="code">        当接收到数据时触发。 </span></div><div class="line"><span class="code">        4. end</span></div><div class="line"><span class="code">        当 socket 另一端发送 FIN 包时，触发该事件。 </span></div><div class="line"><span class="code">        5. timeout</span></div><div class="line"><span class="code">        当 socket 空闲超时时触发，仅是表明 socket 已经空闲。用户必须手动关闭连接。 </span></div><div class="line"><span class="code">        6. drain</span></div><div class="line"><span class="code">        当写缓存为空得时候触发。可用来控制上传。 </span></div><div class="line"><span class="code">        7. error</span></div><div class="line"><span class="code">        错误发生时触发。 </span></div><div class="line"><span class="code">        8. close</span></div><div class="line"><span class="code">        当 socket 完全关闭时触发。参数 had_error 是布尔值，它表示是否因为传输错误导致 socket 关闭。 </span></div><div class="line"></div><div class="line"></div><div class="line"><span class="section">## DNS</span></div><div class="line"><span class="bullet">1. </span>dns.lookup(hostname[, options], callback)</div><div class="line">将域名（比如 'runoob.com'）解析为第一条找到的记录 A （IPV4）或 AAAA(IPV6)。参数 options可以是一个对象或整数。如果没有提供 options，IP v4 和 v6 地址都可以。如果 options 是整数，则必须是 4 或 6。 </div><div class="line"><span class="bullet">2. </span>dns.lookupService(address, port, callback)</div><div class="line">使用 getnameinfo 解析传入的地址和端口为域名和服务。 </div><div class="line"><span class="bullet">3. </span>dns.resolve(hostname[, rrtype], callback)</div><div class="line">将一个域名（如 'runoob.com'）解析为一个 rrtype 指定记录类型的数组。 </div><div class="line"><span class="bullet">4. </span>dns.resolve4(hostname, callback)</div><div class="line">和 dns.resolve() 类似, 仅能查询 IPv4 (A 记录）。 addresses IPv4 地址数组 (比如，['74.125.79.104', '74.125.79.105', '74.125.79.106']）。 </div><div class="line"><span class="bullet">5. </span>dns.resolve6(hostname, callback)</div><div class="line">和 dns.resolve4() 类似， 仅能查询 IPv6( AAAA 查询） </div><div class="line"><span class="bullet">6. </span>dns.resolveMx(hostname, callback)</div><div class="line">和 dns.resolve() 类似, 仅能查询邮件交换(MX 记录)。 </div><div class="line"><span class="bullet">7. </span>dns.resolveTxt(hostname, callback)</div><div class="line">和 dns.resolve() 类似, 仅能进行文本查询 (TXT 记录）。 addresses 是 2-d 文本记录数组。(比如，[ ['v=spf1 ip4:0.0.0.0 ', '~all' ] ]）。 每个子数组包含一条记录的 TXT 块。根据使用情况可以连接在一起，也可单独使用。 </div><div class="line"><span class="bullet">8. </span>dns.resolveSrv(hostname, callback)</div><div class="line">和 dns.resolve() 类似, 仅能进行服务记录查询 (SRV 记录）。 addresses 是 hostname可用的 SRV 记录数组。 SRV 记录属性有优先级（priority），权重（weight）, 端口（port）, 和名字（name） (比如，[&#123;'priority': 10, 'weight': 5, 'port': 21223, 'name': 'service.example.com'&#125;, ...]）。 </div><div class="line"><span class="bullet">9. </span>dns.resolveSoa(hostname, callback)</div><div class="line">和 dns.resolve() 类似, 仅能查询权威记录(SOA 记录）。 </div><div class="line"><span class="bullet">10. </span>dns.resolveNs(hostname, callback)</div><div class="line">和 dns.resolve() 类似, 仅能进行域名服务器记录查询(NS 记录）。 addresses 是域名服务器记录数组（hostname 可以使用） (比如, ['ns1.example.com', 'ns2.example.com']）。 </div><div class="line"><span class="bullet">11. </span>dns.resolveCname(hostname, callback)</div><div class="line">和 dns.resolve() 类似, 仅能进行别名记录查询 (CNAME记录)。addresses 是对 hostname 可用的别名记录数组 (比如，, ['bar.example.com']）。 </div><div class="line"><span class="bullet">12. </span>dns.reverse(ip, callback)</div><div class="line">反向解析 IP 地址，指向该 IP 地址的域名数组。 </div><div class="line"><span class="bullet">13. </span>dns.getServers()</div><div class="line">返回一个用于当前解析的 IP 地址数组的字符串。 </div><div class="line"><span class="bullet">14. </span>dns.setServers(servers)</div><div class="line">指定一组 IP 地址作为解析服务器。 </div><div class="line"></div><div class="line"></div><div class="line"><span class="section">##Domain</span></div><div class="line">Node.js Domain(域) 简化异步代码的异常处理，可以捕捉处理try catch无法捕捉的异常。引入 Domain 模块 语法格式如下：</div><div class="line"></div><div class="line"><span class="bullet">1. </span>domain.run(function)</div><div class="line"> 在域的上下文运行提供的函数，隐式的绑定了所有的事件分发器，计时器和底层请求。 </div><div class="line"><span class="bullet">2. </span>domain.add(emitter)</div><div class="line">显式的增加事件 </div><div class="line"><span class="bullet">3. </span>domain.remove(emitter)</div><div class="line">删除事件。 </div><div class="line"><span class="bullet">4. </span>domain.bind(callback)</div><div class="line">返回的函数是一个对于所提供的回调函数的包装函数。当调用这个返回的函数被时，所有被抛出的错误都会被导向到这个域的 error 事件。 </div><div class="line"><span class="bullet">5. </span>domain.intercept(callback)</div><div class="line">和 domain.bind(callback) 类似。除了捕捉被抛出的错误外，它还会拦截 Error 对象作为参数传递到这个函数。 </div><div class="line"><span class="bullet">6. </span>domain.enter()</div><div class="line"> 进入一个异步调用的上下文，绑定到domain。 </div><div class="line"><span class="bullet">7. </span>domain.exit()</div><div class="line">退出当前的domain，切换到不同的链的异步调用的上下文中。对应domain.enter()。 </div><div class="line"><span class="bullet">8. </span>domain.dispose()</div><div class="line"> 释放一个domain对象，让node进程回收这部分资源。 </div><div class="line"><span class="bullet">9. </span>domain.create()</div><div class="line">返回一个domain对象。 </div><div class="line"></div><div class="line"></div><div class="line"><span class="section">node  web 模块</span></div><div class="line">=================</div><div class="line"><span class="section">## 使用 Node 创建 Web 服务器</span></div></pre></td></tr></table></figure>
<p>var http = require(‘http’);<br>var fs = require(‘fs’);<br>var url = require(‘url’);</p>
<p>// 创建服务器<br>http.createServer( function (request, response) {<br>   // 解析请求，包括文件名<br>   var pathname = url.parse(request.url).pathname;</p>
<p>   // 输出请求的文件名<br>   console.log(“Request for “ + pathname + “ received.”);</p>
<p>   // 从文件系统中读取请求的文件内容<br>   fs.readFile(pathname.substr(1), function (err, data) {<br>      if (err) {<br>         console.log(err);<br>         // HTTP 状态码: 404 : NOT FOUND<br>         // Content Type: text/plain<br>         response.writeHead(404, {‘Content-Type’: ‘text/html’});<br>      }else{<br>         // HTTP 状态码: 200 : OK<br>         // Content Type: text/plain<br>         response.writeHead(200, {‘Content-Type’: ‘text/html’});    </p>
<pre><code>   // 响应文件内容
   response.write(data.toString());        
}
//  发送响应数据
response.end();
</code></pre><p>   });<br>}).listen(8081);</p>
<p>// 控制台会输出以下信息<br>console.log(‘Server running at <a href="http://127.0.0.1:8081/" target="_blank" rel="external">http://127.0.0.1:8081/</a>‘);<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="vala"><span class="meta">## 使用 Node 创建 Web 客户端</span></span></div></pre></td></tr></table></figure></p>
<p>var http = require(‘http’);</p>
<p>// 用于请求的选项<br>var options = {<br>   host: ‘localhost’,<br>   port: ‘8081’,<br>   path: ‘/index.htm’<br>};</p>
<p>// 处理响应的回调函数<br>var callback = function(response){<br>   // 不断更新数据<br>   var body = ‘’;<br>   response.on(‘data’, function(data) {<br>      body += data;<br>   });</p>
<p>   response.on(‘end’, function() {<br>      // 数据接收完成<br>      console.log(body);<br>   });<br>}<br>// 向服务端发送请求<br>var req = http.request(options, callback);<br>req.end();<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="crmsh"><span class="keyword">Node</span>.<span class="title">js</span> Express 框架</span></div><div class="line">=====================</div><div class="line">Express 简介</div><div class="line"></div><div class="line">Express 是一个简洁而灵活的 <span class="keyword">node</span>.<span class="title">js</span> Web应用框架, 提供了一系列强大特性帮助你创建各种 Web 应用，和丰富的 HTTP 工具。</div><div class="line"></div><div class="line">使用 Express 可以快速地搭建一个完整功能的网站。</div><div class="line"></div><div class="line">Express 框架核心特性：</div><div class="line"></div><div class="line">* 可以设置中间件来响应 HTTP 请求。</div><div class="line">* 定义了路由表用于执行不同的 HTTP 请求动作。 </div><div class="line">* 可以通过向模板传递参数来动态渲染 HTML 页面。</div><div class="line"></div><div class="line">&gt;   $ npm install express --save   </div><div class="line">    $ npm install body-parser --save  </div><div class="line">    $ npm install cookie-parser --save  </div><div class="line">    $ npm install multer --save  </div><div class="line"></div><div class="line">以上命令会将 Express 框架安装在当期目录的 <span class="keyword">node</span><span class="title">\_modules</span> 目录中， node_modules 目录下会自动创建 express 目录。以下几个重要的模块是需要与 express 框架一起安装的：</div><div class="line"></div><div class="line">body-parser - <span class="keyword">node</span>.<span class="title">js</span> 中间件，用于处理 JSON, Raw, Text 和 URL 编码的数据。</div><div class="line"></div><div class="line">cookie-parser - 这就是一个解析Cookie的工具。通过req.cookies可以取到传过来的cookie，并把它们转成对象。</div><div class="line"></div><div class="line">multer - <span class="keyword">node</span>.<span class="title">js</span> 中间件，用于处理 <span class="attr">enctype=</span><span class="string">"multipart/form-data"</span>（设置表单的MIME编码）的表单数据。</div></pre></td></tr></table></figure></p>
<p>//express_demo.js 文件<br>var express = require(‘express’);<br>var app = express();</p>
<p>app.get(‘/‘, function (req, res) {<br>   res.send(‘Hello World’);<br>})</p>
<p>var server = app.listen(8081, function () {</p>
<p>  var host = server.address().address<br>  var port = server.address().port</p>
<p>  console.log(“应用实例，访问地址为 <a href="http://%s:%s" target="_blank" rel="external">http://%s:%s</a>“, host, port)</p>
<p>})<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="section">## request 和 response 对象的具体介绍：</span></div><div class="line"></div><div class="line"><span class="bullet">* </span>Request 对象 - request 对象表示 HTTP 请求，包含了请求查询字符串，参数，内容，HTTP 头部等属性。常见属性有： </div><div class="line"></div><div class="line"><span class="bullet">1. </span>req.app：当callback为外部文件时，用req.app访问express的实例</div><div class="line"><span class="bullet">2. </span>req.baseUrl：获取路由当前安装的URL路径</div><div class="line"><span class="bullet">3. </span>req.body / req.cookies：获得「请求主体」/ Cookies</div><div class="line"><span class="bullet">4. </span>req.fresh / req.stale：判断请求是否还「新鲜」</div><div class="line"><span class="bullet">5. </span>req.hostname / req.ip：获取主机名和IP地址</div><div class="line"><span class="bullet">6. </span>req.originalUrl：获取原始请求URL</div><div class="line"><span class="bullet">7. </span>req.params：获取路由的parameters</div><div class="line"><span class="bullet">8. </span>req.path：获取请求路径</div><div class="line"><span class="bullet">9. </span>req.protocol：获取协议类型</div><div class="line"><span class="bullet">10. </span>req.query：获取URL的查询参数串</div><div class="line"><span class="bullet">11. </span>req.route：获取当前匹配的路由</div><div class="line"><span class="bullet">12. </span>req.subdomains：获取子域名</div><div class="line"><span class="bullet">13. </span>req.accpets（）：检查请求的Accept头的请求类型</div><div class="line"><span class="bullet">14. </span>req.acceptsCharsets / req.acceptsEncodings / req.acceptsLanguages</div><div class="line"><span class="bullet">15. </span>req.get（）：获取指定的HTTP请求头</div><div class="line"><span class="bullet">16. </span>req.is（）：判断请求头Content-Type的MIME类型</div><div class="line"></div><div class="line"><span class="bullet">* </span>Response 对象 - response 对象表示 HTTP 响应，即在接收到请求时向客户端发送的 HTTP 响应数据。常见属性有：</div><div class="line"><span class="bullet">1. </span>res.app：同req.app一样</div><div class="line"><span class="bullet">2. </span>res.append（）：追加指定HTTP头</div><div class="line"><span class="bullet">3. </span>res.set（）在res.append（）后将重置之前设置的头</div><div class="line"><span class="bullet">4. </span>res.cookie（name，value [，option]）：设置Cookie</div><div class="line"><span class="bullet">5. </span>opition: domain / expires / httpOnly / maxAge / path / secure / signed</div><div class="line"><span class="bullet">6. </span>res.clearCookie（）：清除Cookie</div><div class="line"><span class="bullet">7. </span>res.download（）：传送指定路径的文件</div><div class="line"><span class="bullet">8. </span>res.get（）：返回指定的HTTP头</div><div class="line"><span class="bullet">9. </span>res.json（）：传送JSON响应</div><div class="line"><span class="bullet">10. </span>res.jsonp（）：传送JSONP响应</div><div class="line"><span class="bullet">11. </span>res.location（）：只设置响应的Location HTTP头，不设置状态码或者close response</div><div class="line"><span class="bullet">12. </span>res.redirect（）：设置响应的Location HTTP头，并且设置状态码302</div><div class="line"><span class="bullet">13. </span>res.send（）：传送HTTP响应</div><div class="line"><span class="bullet">14. </span>res.sendFile（path [，options] [，fn]）：传送指定路径的文件 -会自动根据文件extension设定Content-Type</div><div class="line"><span class="bullet">15. </span>res.set（）：设置HTTP头，传入object可以一次设置多个头</div><div class="line"><span class="bullet">16. </span>res.status（）：设置HTTP状态码</div><div class="line"><span class="bullet">17. </span>res.type（）：设置Content-Type的MIME类型</div><div class="line"></div><div class="line"><span class="section">## 路由</span></div></pre></td></tr></table></figure></p>
<p>var express = require(‘express’);<br>var app = express();</p>
<p>//  主页输出 “Hello World”<br>app.get(‘/‘, function (req, res) {<br>   console.log(“主页 GET 请求”);<br>   res.send(‘Hello GET’);<br>})</p>
<p>//  POST 请求<br>app.post(‘/‘, function (req, res) {<br>   console.log(“主页 POST 请求”);<br>   res.send(‘Hello POST’);<br>})</p>
<p>//  /del_user 页面响应<br>app.delete(‘/del_user’, function (req, res) {<br>   console.log(“/del_user 响应 DELETE 请求”);<br>   res.send(‘删除页面’);<br>})</p>
<p>//  /list_user 页面 GET 请求<br>app.get(‘/list_user’, function (req, res) {<br>   console.log(“/list_user GET 请求”);<br>   res.send(‘用户列表页面’);<br>})</p>
<p>// 对页面 abcd, abxcd, ab123cd, 等响应 GET 请求<br>app.get(‘/ab<em>cd’, function(req, res) {<br>   console.log(“/ab</em>cd GET 请求”);<br>   res.send(‘正则匹配’);<br>})</p>
<p>var server = app.listen(8081, function () {</p>
<p>  var host = server.address().address<br>  var port = server.address().port</p>
<p>  console.log(“应用实例，访问地址为 <a href="http://%s:%s" target="_blank" rel="external">http://%s:%s</a>“, host, port)</p>
<p>})<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="vala"><span class="meta">## 静态文件</span></span></div><div class="line">Express 提供了内置的中间件 express.<span class="keyword">static</span>  来设置静态文件如：图片， CSS, JavaScript 等。</div><div class="line"></div><div class="line">你可以使用 express.<span class="keyword">static</span>  中间件来设置静态文件路径。例如，如果你将图片， CSS, JavaScript 文件放在 <span class="keyword">public</span> 目录下，你可以这么写：</div><div class="line"></div><div class="line"></div><div class="line">&gt; app.use(express.<span class="keyword">static</span>(<span class="string">'public'</span>));</div><div class="line"></div><div class="line"><span class="meta">## 获取 GET 方法参数</span></div></pre></td></tr></table></figure></p>
<p>var express = require(‘express’);<br>var app = express();</p>
<p>app.use(express.static(‘public’));</p>
<p>app.get(‘/index.htm’, function (req, res) {<br>   res.sendFile( __dirname + “/“ + “index.htm” );<br>})</p>
<p>app.get(‘/process_get’, function (req, res) {</p>
<p>   // 输出 JSON 格式<br>   response = {<br>       first_name:req.query.first_name,<br>       last_name:req.query.last_name<br>   };<br>   console.log(response);<br>   res.end(JSON.stringify(response));<br>})</p>
<p>var server = app.listen(8081, function () {</p>
<p>  var host = server.address().address<br>  var port = server.address().port</p>
<p>  console.log(“应用实例，访问地址为 <a href="http://%s:%s" target="_blank" rel="external">http://%s:%s</a>“, host, port)</p>
<p>})<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">## 获取 POST 方法参数</span></div></pre></td></tr></table></figure></p>
<p>var express = require(‘express’);<br>var app = express();<br>var bodyParser = require(‘body-parser’);</p>
<p>// 创建 application/x-www-form-urlencoded 编码解析<br>var urlencodedParser = bodyParser.urlencoded({ extended: false })</p>
<p>app.use(express.static(‘public’));</p>
<p>app.get(‘/index.htm’, function (req, res) {<br>   res.sendFile( __dirname + “/“ + “index.htm” );<br>})</p>
<p>app.post(‘/process_post’, urlencodedParser, function (req, res) {</p>
<p>   // 输出 JSON 格式<br>   response = {<br>       first_name:req.body.first_name,<br>       last_name:req.body.last_name<br>   };<br>   console.log(response);<br>   res.end(JSON.stringify(response));<br>})</p>
<p>var server = app.listen(8081, function () {</p>
<p>  var host = server.address().address<br>  var port = server.address().port</p>
<p>  console.log(“应用实例，访问地址为 <a href="http://%s:%s" target="_blank" rel="external">http://%s:%s</a>“, host, port)</p>
<p>})<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">## 文件上传</span></div></pre></td></tr></table></figure></p>
<p>var express = require(‘express’);<br>var app = express();<br>var fs = require(“fs”);</p>
<p>var bodyParser = require(‘body-parser’);<br>var multer  = require(‘multer’);</p>
<p>app.use(express.static(‘public’));<br>app.use(bodyParser.urlencoded({ extended: false }));<br>app.use(multer({ dest: ‘/tmp/‘}).array(‘image’));</p>
<p>app.get(‘/index.htm’, function (req, res) {<br>   res.sendFile( __dirname + “/“ + “index.htm” );<br>})</p>
<p>app.post(‘/file_upload’, function (req, res) {</p>
<p>   console.log(req.files[0]);  // 上传的文件信息</p>
<p>   var des_file = __dirname + “/“ + req.files[0].originalname;<br>   fs.readFile( req.files[0].path, function (err, data) {<br>        fs.writeFile(des_file, data, function (err) {<br>         if( err ){<br>              console.log( err );<br>         }else{<br>               response = {<br>                   message:’File uploaded successfully’,<br>                   filename:req.files[0].originalname<br>              };<br>          }<br>          console.log( response );<br>          res.end( JSON.stringify( response ) );<br>       });<br>   });<br>})</p>
<p>var server = app.listen(8081, function () {</p>
<p>  var host = server.address().address<br>  var port = server.address().port</p>
<p>  console.log(“应用实例，访问地址为 <a href="http://%s:%s" target="_blank" rel="external">http://%s:%s</a>“, host, port)</p>
<p>})<br><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="vala"><span class="meta">## Cookie 管理</span></span></div></pre></td></tr></table></figure></p>
<p>// express_cookie.js 文件<br>var express      = require(‘express’)<br>var cookieParser = require(‘cookie-parser’)</p>
<p>var app = express()<br>app.use(cookieParser())</p>
<p>app.get(‘/‘, function(req, res) {<br>  console.log(“Cookies: “, req.cookies)<br>})</p>
<p>app.listen(8081)<br>```</p>
<h1 id="npm-命令"><a href="#npm-命令" class="headerlink" title="npm 命令"></a>npm 命令</h1><ol>
<li><p>npm install express  安装express模块</p>
<ul>
<li>默认在当前目录产生 node_modules 目录 下</li>
<li>-g : npm install -g express<br>  安装到node程序目录下的 node_modules 目录 下</li>
<li>npm get global : 查看是否使用全局模式 返回 true/false</li>
<li>npm install express@3.0.6 : 指定模块安装版本</li>
<li>全局安装时供命令行使用的 , require() 是无法导入的</li>
<li>–save : 将安装信息写入 package.json 中, 类似 pip 的requirement 文件<br>  npm install express –save : 安装express模块并记录到package.json 文件中<br>  推送到github 时就不需要 node_modules 目录了<br>  npm install : 安装 package.json 记录的依赖 类似 pip install -r requirement.txt</li>
</ul>
</li>
<li><p>npm init : 创建 package.json 包文件</p>
<ul>
<li>包的入口 main 字段指定, 没有则会寻找 index.js 或者 index.node  。 类似 python 的 <code>__init__.py</code></li>
<li>.npmignore 忽略掉不发布到npm的文件</li>
</ul>
</li>
<li><p>npm view express :  查看模块的package.json 包</p>
</li>
<li><p>npm list : 查看当前目录下安装的 node 包</p>
</li>
<li><p>npm view moudleName dependencies：查看包的依赖关系</p>
</li>
<li><p>npm view moduleName repository.url：查看包的源文件地址</p>
</li>
<li><p>npm view moduleName engines：查看包所依赖的Node的版本</p>
</li>
<li><p>npm help folders：查看npm使用的所有文件夹</p>
</li>
<li><p>npm rebuild moduleName：用于更改包内容后进行重建</p>
</li>
<li><p>npm outdated：检查包是否已经过时，此命令会列出所有已经过时的包，可以及时进行包的更新</p>
</li>
<li><p>npm update moduleName：更新node模块</p>
</li>
<li><p>npm uninstall moudleName：卸载node模块</p>
</li>
<li><p>一个npm包是包含了package.json的文件夹，package.json描述了这个文件夹的结构。访问npm的json文件夹的方法如下：<br>$ npm help json<br>此命令会以默认的方式打开一个网页，如果更改了默认打开程序则可能不会以网页的形式打开。</p>
</li>
<li><p>发布一个npm包的时候，需要检验某个包名是否已存在<br>$ npm search packageName</p>
</li>
<li><p>npm init：会引导你创建一个package.json文件，包括名称. 版本. 作者这些信息等</p>
</li>
<li><p>npm root：查看当前包的安装路径<br>npm root -g：查看全局的包的安装路径</p>
</li>
<li><p>npm -v：查看npm安装的版本</p>
</li>
</ol>
<h1 id="附"><a href="#附" class="headerlink" title="附"></a>附</h1><ul>
<li>使用流程 <ol>
<li>git clone 下来 </li>
<li>npm install : 安装依赖包</li>
<li>确认有themes 目录 hexo  生成页面需要用到<br>如果没有用hexo init 生成</li>
</ol>
</li>
<li><p>或者是 </p>
<ol>
<li>hexo init :  得到hexo环境</li>
<li>另外目录 git clone  得到代码仓库</li>
<li>复制 .git 目录到 hexo 环境中</li>
<li>检出仓库中的文件</li>
</ol>
</li>
<li><p>在执行 hexo deploy 后,出现 error deployer not found:git 的错误</p>
</li>
</ul>
<p><code>npm install hexo-deployer-git --save</code>改了之后执行，然后再部署试试</p>
<ul>
<li>没有 <code>hexo server</code> 命令 </li>
</ul>
<p><code>npm install hexo-server --save</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://hongdaorongthink.github.io/2016/07/21/node的使用/" data-id="cirou3vtm000da8m3b3fewgsw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node/">node</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/antlr/">antlr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bug/">bug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome/">chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crontab/">crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/easyui/">easyui</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/json/">json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plan/">plan</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quartz/">quartz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/work/">work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/书签/">书签</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/定时任务/">定时任务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据分析/">数据分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/语法解析/">语法解析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/金仕达/">金仕达</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/antlr/" style="font-size: 10px;">antlr</a> <a href="/tags/bug/" style="font-size: 10px;">bug</a> <a href="/tags/c/" style="font-size: 13.33px;">c++</a> <a href="/tags/chrome/" style="font-size: 10px;">chrome</a> <a href="/tags/crontab/" style="font-size: 10px;">crontab</a> <a href="/tags/easyui/" style="font-size: 10px;">easyui</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/plan/" style="font-size: 10px;">plan</a> <a href="/tags/python/" style="font-size: 16.67px;">python</a> <a href="/tags/quartz/" style="font-size: 16.67px;">quartz</a> <a href="/tags/work/" style="font-size: 13.33px;">work</a> <a href="/tags/书签/" style="font-size: 10px;">书签</a> <a href="/tags/定时任务/" style="font-size: 13.33px;">定时任务</a> <a href="/tags/数据分析/" style="font-size: 10px;">数据分析</a> <a href="/tags/语法解析/" style="font-size: 10px;">语法解析</a> <a href="/tags/金仕达/" style="font-size: 10px;">金仕达</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/08/10/收藏夹/">收藏夹</a>
          </li>
        
          <li>
            <a href="/2016/08/08/antlr4/">antlr4</a>
          </li>
        
          <li>
            <a href="/2016/08/08/学习框架/">学习框架</a>
          </li>
        
          <li>
            <a href="/2016/08/03/科学计算/">科学计算</a>
          </li>
        
          <li>
            <a href="/2016/08/01/写一个简单服务框架/">写一个简单服务框架</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 HongDR<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>